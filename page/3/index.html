<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>ChionLab | 一个萌豚开发者的窝 </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Chion82(Chion Tang)的技术博客，分享御宅开发者的点点滴滴">
<meta property="og:type" content="website">
<meta property="og:title" content="ChionLab">
<meta property="og:url" content="http://blog.chionlab.moe/page/3/index.html">
<meta property="og:site_name" content="ChionLab">
<meta property="og:description" content="Chion82(Chion Tang)的技术博客，分享御宅开发者的点点滴滴">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ChionLab">
<meta name="twitter:description" content="Chion82(Chion Tang)的技术博客，分享御宅开发者的点点滴滴">
  
    <link rel="alternate" href="/atom.xml" title="ChionLab" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
    <link rel="apple-touch-icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">ChionLab</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">欢迎来到Chion82的未来道具研究所 ( ゜- ゜)つロ 乾杯~</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <!-- <a class="main-nav-link" href="/">主页</a> -->
          <a class="main-nav-link" href="/">主页</a>
        
          <!-- <a class="main-nav-link" href="/archives">归档</a> -->
          <a class="main-nav-link" href="/archives">归档</a>
        
          <!-- <a class="main-nav-link" href="https://github.com/Chion82">GitHub</a> -->
          <a class="main-nav-link" href="https://github.com/Chion82">GitHub</a>
        
          <!-- <a class="main-nav-link" href="/about.html">About Me</a> -->
          <a class="main-nav-link" href="/about.html">About Me</a>
        

        
          <div style="clear: both;"></div>
          <style>
            .switch-theme-btn {
              opacity: 0.8 !important;
            }

            .switch-theme-btn:hover {
              opacity: 1.0 !important;
            }
          </style>
          <div>
            
              <a class="main-nav-link switch-theme-btn"
                title="uzume" href="#" style="float: left;margin-right: -10px;"
                data-css-url="/css/style.css"
                data-theme-name="uzume">
                <div style="width:38px; height: 38px; overflow:hidden; border-radius:19px;">
                  <img style="width: 100%; height: 100%;" src="/images/theme_uzume.png" />
                </div>
              </a>
            
              <a class="main-nav-link switch-theme-btn"
                title="miria" href="#" style="float: left;margin-right: -10px;"
                data-css-url="/stylesheets/theme_miria.css"
                data-theme-name="miria">
                <div style="width:38px; height: 38px; overflow:hidden; border-radius:19px;">
                  <img style="width: 100%; height: 100%;" src="/images/theme_miria.png" />
                </div>
              </a>
            
          </div>
          <script>
            (function(){

              var JsCookies = {
              	// this gets a cookie and returns the cookies value, if no cookies it returns blank ""
              	get: function(c_name) {
              		if (document.cookie.length > 0) {
              			var c_start = document.cookie.indexOf(c_name + "=");
              			if (c_start != -1) {
              				c_start = c_start + c_name.length + 1;
              				var c_end = document.cookie.indexOf(";", c_start);
              				if (c_end == -1) {
              					c_end = document.cookie.length;
              				}
              				return unescape(document.cookie.substring(c_start, c_end));
              			}
              		}
              		return "";
              	},

              	// this sets a cookie with your given ("cookie name", "cookie value", "good for x days")
              	set: function(c_name, value, expiredays) {
              		var exdate = new Date();
                  if (expiredays)
              		  exdate.setDate(exdate.getDate() + expiredays);
              		document.cookie = c_name + "=" + escape(value) + "; path=/" + ((expiredays == undefined) ? "" : "; expires=" + exdate.toUTCString());
              	},

              	// this checks to see if a cookie exists, then returns true or false
              	check: function(c_name) {
              		c_name = JsCookies.get(c_name);
              		if (c_name != null && c_name != "") {
              			return true;
              		} else {
              			return false;
              		}
              	}

              };

              function switchThemeCSS(themeName, cssUrl) {
                document.querySelector('head').querySelectorAll('link[rel=stylesheet]')[1].href = cssUrl;
              }

              var switchThemeBtns = document.querySelectorAll('.switch-theme-btn');
              for (var i=0; i<switchThemeBtns.length; i++) {
                var switchThemeBtn = switchThemeBtns[i];
                (function(switchThemeBtn) {
                  switchThemeBtn.addEventListener('click', function(){
                    switchThemeCSS(switchThemeBtn.dataset.themeName, switchThemeBtn.dataset.cssUrl);
                    JsCookies.set('theme', switchThemeBtn.dataset.themeName);
                  });
                })(switchThemeBtn);
              }

              var initTheme = JsCookies.get('theme');
              if (initTheme) {
                var cssUrl = document.querySelector(".switch-theme-btn[data-theme-name='" + initTheme + "']").dataset.cssUrl;
                switchThemeCSS(initTheme, cssUrl);
              }

            })();
          </script>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://blog.chionlab.moe"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-use-xposed-to-crawl-wechat-moments" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/22/use-xposed-to-crawl-wechat-moments/" class="article-date">
  <time datetime="2016-01-22T15:38:02.000Z" itemprop="datePublished">2016-01-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/开发笔记/">开发笔记</a>►<a class="article-category-link" href="/categories/开发笔记/安卓/">安卓</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/22/use-xposed-to-crawl-wechat-moments/">用Xposed框架抓取微信朋友圈数据</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>因微信朋友圈为私有协议，从抓包上分析朋友圈数据几乎不可能，目前也尚未找到开源的抓取朋友圈的脚本。博主于是尝试通过使用安卓下的Xposed框架实现从微信安卓版上抓取朋友圈数据。<br>本文针对微信版本6.3.8。<br><a href="https://github.com/Chion82/WeChatMomentExport" target="_blank" rel="external">GitHub仓库</a></p>
<h2 id="主要思路"><a href="#主要思路" class="headerlink" title="主要思路"></a>主要思路</h2><p>从UI获取文本信息是最为简单的方法，于是应该优先逆向UI代码部分。</p>
<h2 id="逆向微信apk"><a href="#逆向微信apk" class="headerlink" title="逆向微信apk"></a>逆向微信apk</h2><p>首先解包微信apk，用dex2jar反编译classes.dex，然后用JD-GUI查看jar源码。<br>当然，能看到的源码都是经过高度混淆的。但是，继承自安卓重要组件（如Activity、Service等）的类名无法被混淆，于是还是能从中看到点东西。</p>
<ol>
<li>首先定位到微信APP package。我们知道这个是<code>com.tencent.mm</code>。</li>
<li>在<code>com.tencent.mm</code>中，我们找到一个<code>ui</code>包，有点意思。</li>
<li>展开<code>com.tencent.mm.ui</code>，发现多个未被混淆的类，其中发现<code>MMBaseActivity</code>直接继承自<code>Activity</code>，<code>MMFragmentActivity</code>继承自<code>ActionBarActivity</code>，<code>MMActivity</code>继承自<code>MMFragmentActivity</code>，并且<code>MMActivity</code>是微信中大多数Activity的父类：<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MMFragmentActivity</span></span></div><div class="line">  <span class="keyword">extends</span> <span class="title">ActionBarActivity</span></div><div class="line">  <span class="keyword">implements</span> <span class="title">SwipeBackLayout</span>.<span class="title">a</span>, <span class="title">b</span>.<span class="title">a</span> &#123;</div><div class="line">    ...</div><div class="line">&#125;</div><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">MMActivity</span></span></div><div class="line">  <span class="keyword">extends</span> <span class="title">MMFragmentActivity</span> &#123;</div><div class="line">    ...</div><div class="line">&#125;</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MMBaseActivity</span></span></div><div class="line">  <span class="keyword">extends</span> <span class="title">Activity</span> &#123;</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>现在需要找出朋友圈的Activity，为此要用Xposed hook<code>MMActivity</code>。</p>
<h2 id="创建一个Xposed模块"><a href="#创建一个Xposed模块" class="headerlink" title="创建一个Xposed模块"></a>创建一个Xposed模块</h2><p>参考<a href="http://forum.xda-developers.com/showthread.php?t=2709324" target="_blank" rel="external">[TUTORIAL]Xposed module devlopment</a>，创建一个Xposed项目。<br>简单Xposed模块的基本思想是：hook某个APP中的某个方法，从而达到读写数据的目的。<br>小编尝试hook<code>com.tencent.mm.ui.MMActivity.setContentView</code>这个方法，并打印出这个Activity下的全部TextView内容。那么首先需要遍历这个Activity下的所有TextView，遍历ViewGroup的方法参考了SO的以下代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">getAllTextViews</span><span class="params">(<span class="keyword">final</span> View v)</span> </span>&#123;</div><div class="line">   <span class="keyword">if</span> (v <span class="keyword">instanceof</span> ViewGroup) &#123;</div><div class="line">       ViewGroup vg = (ViewGroup) v;</div><div class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; vg.getChildCount(); i++) &#123;</div><div class="line">           View child = vg.getChildAt(i);</div><div class="line">           getAllTextViews(child);</div><div class="line">       &#125;</div><div class="line">   &#125; <span class="keyword">else</span> <span class="keyword">if</span> (v <span class="keyword">instanceof</span> TextView ) &#123;</div><div class="line">       dealWithTextView((TextView)v); <span class="comment">//dealWithTextView(TextView tv)方法：打印TextView中的显示文本</span></div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Hook<code>MMActivity.setContentView</code>的关键代码如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">findAndHookMethod(<span class="string">"com.tencent.mm.ui.MMActivity"</span>, lpparam.classLoader, <span class="string">"setContentView"</span>, View.class, <span class="keyword">new</span> XC_MethodHook() &#123;</div><div class="line">  ...</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>在findAndHookMethod方法中，第一个参数为完整类名，第三个参数为需要hook的方法名，其后若干个参数分别对应该方法的各形参类型。在这里，<code>Activity.setContentView(View view)</code>方法只有一个类型为<code>View</code>的形参，因此传入一个<code>View.class</code>。<br>现在，期望的结果是运行时可以从Log中读取到每个Activity中的所有的TextView的显示内容。<br><strong>但是，因为View中的数据并不一定在<code>setContentView()</code>时就加载完毕，因此小编的实验结果是，log中啥都没有。</strong></p>
<h2 id="意外的收获"><a href="#意外的收获" class="headerlink" title="意外的收获"></a>意外的收获</h2><p>当切换到朋友圈页面时，Xposed模块报了一个异常，异常源从<code>com.tencent.mm.plugin.sns.ui.SnsTimeLineUI</code>这个类捕捉到。从类名上看，这个很有可能是朋友圈首页的UI类。展开这个类，发现更多有趣的东西：<br>这个类下有个子类<code>a</code>(被混淆过的类名)，该子类下有个名为<code>gyO</code>的<code>ListView</code>类的实例。我们知道，<code>ListView</code>是显示列表类的UI组件，有可能就是用来展示朋友圈的列表。</p>
<h2 id="顺藤摸瓜"><a href="#顺藤摸瓜" class="headerlink" title="顺藤摸瓜"></a>顺藤摸瓜</h2><p>那么，我们先要获得一个<code>SnsTimeLineUI.a.gyO</code>的实例。但是在这之前，要先获得一个<code>com.tencent.mm.plugin.sns.ui.SnsTimeLineUI.a</code>的实例。继续搜索，发现<code>com.tencent.mm.plugin.sns.ui.SnsTimeLineUI</code>有一个名为<code>gLZ</code>的<code>SnsTimeLineUI.a</code>实例，那么我们先取得这个实例。</p>
<p>经过测试，<code>com.tencent.mm.plugin.sns.ui.SnsTimeLineUI.a(boolean, boolean, String, boolean)</code>这个方法在每次初始化微信界面的时候都会被调用。因此我们将hook这个方法，并从中取得<code>gLZ</code>。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">findAndHookMethod(<span class="string">"com.tencent.mm.plugin.sns.ui.SnsTimeLineUI"</span>, lpparam.classLoader, <span class="string">"a"</span>, <span class="keyword">boolean</span>.class, <span class="keyword">boolean</span>.class, String.class, <span class="keyword">boolean</span>.class, <span class="keyword">new</span> XC_MethodHook() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">afterHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">        XposedBridge.log(<span class="string">"Hooked. "</span>);</div><div class="line">        Object currentObject = param.thisObject;</div><div class="line">        <span class="keyword">for</span> (Field field : currentObject.getClass().getDeclaredFields()) &#123; <span class="comment">//遍历类成员</span></div><div class="line">            field.setAccessible(<span class="keyword">true</span>);</div><div class="line">            Object value = field.get(currentObject);</div><div class="line">            <span class="keyword">if</span> (field.getName().equals(<span class="string">"gLZ"</span>)) &#123;</div><div class="line">                XposedBridge.log(<span class="string">"Child A found."</span>);</div><div class="line">                childA = value;</div><div class="line">                <span class="comment">//这里获得了gLZ</span></div><div class="line">                ...</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>现在取得了<code>SnsTimeLineUI.a</code>的一个实例<code>gLZ</code>，需要取得这个类下的<code>ListView</code>类型的<code>gyO</code>属性。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">dealWithA</span><span class="params">()</span> <span class="keyword">throws</span> Throwable</span>&#123;</div><div class="line">    <span class="keyword">if</span> (childA == <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (Field field : childA.getClass().getDeclaredFields()) &#123; <span class="comment">//遍历属性</span></div><div class="line">        field.setAccessible(<span class="keyword">true</span>);</div><div class="line">        Object value = field.get(childA);</div><div class="line">        <span class="keyword">if</span> (field.getName().equals(<span class="string">"gyO"</span>)) &#123;  <span class="comment">//取得了gyO</span></div><div class="line">            ViewGroup vg = (ListView)value;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; vg.getChildCount(); i++) &#123;  <span class="comment">//遍历这个ListView的每一个子View</span></div><div class="line">                ...</div><div class="line">                View child = vg.getChildAt(i);</div><div class="line">                getAllTextViews(child); <span class="comment">//这里调用上文的getAllTextViews()方法，每一个子View里的所有TextView的文本</span></div><div class="line">                ...</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>现在已经可以将朋友圈页面中的全部文字信息打印出来了。我们需要根据TextView的子类名判断这些文字是朋友圈内容、好友昵称、点赞或评论等。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">dealWithTextView</span><span class="params">(TextView v)</span> </span>&#123;</div><div class="line">        String className = v.getClass().getName();</div><div class="line">        String text = ((TextView)v).getText().toString().trim().replaceAll(<span class="string">"\n"</span>, <span class="string">" "</span>);</div><div class="line">        <span class="keyword">if</span> (!v.isShown())</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        <span class="keyword">if</span> (text.equals(<span class="string">""</span>))</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        <span class="keyword">if</span> (className.equals(<span class="string">"com.tencent.mm.plugin.sns.ui.AsyncTextView"</span>)) &#123;</div><div class="line">            <span class="comment">//好友昵称</span></div><div class="line">            ...</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (className.equals(<span class="string">"com.tencent.mm.plugin.sns.ui.SnsTextView"</span>)) &#123;</div><div class="line">            <span class="comment">//朋友圈文字内容</span></div><div class="line">            ...</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (className.equals(<span class="string">"com.tencent.mm.plugin.sns.ui.MaskTextView"</span>)) &#123;</div><div class="line">            <span class="keyword">if</span> (!text.contains(<span class="string">":"</span>)) &#123;</div><div class="line">                <span class="comment">//点赞</span></div><div class="line">                ...</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="comment">//评论</span></div><div class="line">                ...</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<p>自此，我们已经从微信APP里取得了朋友圈数据。当然，这部分抓取代码需要定时执行。因为从<code>ListView</code>中抓到的数据只有当前显示在屏幕上的可见部分，为此需要每隔很短一段时间再次执行，让用户在下滑加载的过程中抓取更多数据。<br>剩下的就是数据分类处理和格式化输出到文件，受本文篇幅所限不再赘述，详细实现可参考作者GitHub上的源码。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.chionlab.moe/2016/01/22/use-xposed-to-crawl-wechat-moments/" data-id="ciwkezn380021lr2h99iy2co3" class="article-share-link">分享</a>
      
        <a href="http://blog.chionlab.moe/2016/01/22/use-xposed-to-crawl-wechat-moments/#disqus_thread" class="article-comment-link">评论</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hack/">hack</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-python2.7-on-centos6" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/22/python2.7-on-centos6/" class="article-date">
  <time datetime="2016-01-21T18:11:53.000Z" itemprop="datePublished">2016-01-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/学习笔记/">学习笔记</a>►<a class="article-category-link" href="/categories/学习笔记/linux/">linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/22/python2.7-on-centos6/">在CentOS6上编译安装Python2.7</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>参考了友站的博文<a href="https://www.starduster.me/2016/01/04/py27-on-centos6/" target="_blank" rel="external">CentOS6上的Python2.7问题</a>，正如所言，在CentOS6上安装Python2.7是非常头疼的问题。友站的这篇博文阐述了如何了从源安装Python2.7，本站则讲述从源码编译安装要注意的问题。<br>编译依赖参考<a href="http://toomuchdata.com/2014/02/16/how-to-install-python-on-centos/" target="_blank" rel="external">How to install Python 2.7 and Python 3.3 on CentOS 6</a>。</p>
<h2 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h2><p><strong>十分重要:</strong> 编译Python2.7之前务必安装齐必须依赖。在configure过程中，若缺少依赖则不会报错，编译也可顺利通过，但编译出的Python将缺少几个必要模块，导致在运行<code>ez_setup.py</code>时出错。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># yum groupinstall &quot;Development tools&quot;</div><div class="line"># yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel</div></pre></td></tr></table></figure>
<h2 id="编译和安装"><a href="#编译和安装" class="headerlink" title="编译和安装"></a>编译和安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ wget http://python.org/ftp/python/2.7.6/Python-2.7.6.tar.xz</div><div class="line">$ tar xf Python-2.7.6.tar.xz</div><div class="line">$ cd Python-2.7.6</div><div class="line">$ ./configure --prefix=/usr/local --enable-unicode=ucs4 --enable-shared LDFLAGS=&quot;-Wl,-rpath /usr/local/lib&quot;</div><div class="line"># make &amp;&amp; make altinstall</div></pre></td></tr></table></figure>
<p>这将会把Python2.7安装在<code>/usr/local/bin/python2.7</code></p>
<h2 id="将默认Python版本从2-6改为2-7"><a href="#将默认Python版本从2-6改为2-7" class="headerlink" title="将默认Python版本从2.6改为2.7"></a>将默认Python版本从2.6改为2.7</h2><p>首先将<code>/usr/bin/python</code>这个软链接指向刚刚安装的Python2.7<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># rm /usr/bin/python</div><div class="line"># ln -s /usr/local/bin/python2.7 /usr/bin/python</div></pre></td></tr></table></figure></p>
<p><strong>重要：</strong> 进行这步操作后，yum会失效，运行即报错。这是因为<code>/usr/bin/yum</code>其实是个python2.6脚本，刚刚安装的python2.7缺少yum的相关依赖。因此需要改动<code>/usr/bin/yum</code>的解释器。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># vim /usr/bin/yum</div></pre></td></tr></table></figure></p>
<p>将第一行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#!/usr/bin/python</div></pre></td></tr></table></figure></p>
<p>改为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#!/usr/bin/python2.6</div></pre></td></tr></table></figure></p>
<p>现在运行<code>yum --version</code>应该不会再报错</p>
<h2 id="安装pip"><a href="#安装pip" class="headerlink" title="安装pip"></a>安装pip</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ wget https://bitbucket.org/pypa/setuptools/raw/bootstrap/ez_setup.py</div><div class="line"># python ez_setup.py</div><div class="line"># easy_install-2.7 pip</div></pre></td></tr></table></figure>
<h2 id="替换默认pip为pip2-7"><a href="#替换默认pip为pip2-7" class="headerlink" title="替换默认pip为pip2.7"></a>替换默认pip为pip2.7</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># vim /usr/bin/pip2.6 #第一行改为#!/usr/bin/python2.6</div><div class="line">$ which pip2.7  #应该返回/usr/local/bin/pip2.7</div><div class="line"># rm /usr/bin/pip</div><div class="line"># ln -s /usr/local/bin/pip2.7 /usr/bin/pip</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.chionlab.moe/2016/01/22/python2.7-on-centos6/" data-id="ciwkezn2r001elr2hash2foap" class="article-share-link">分享</a>
      
        <a href="http://blog.chionlab.moe/2016/01/22/python2.7-on-centos6/#disqus_thread" class="article-comment-link">评论</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/maintenance/">maintenance</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-netease-music-app-reversed-proxy" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/21/netease-music-app-reversed-proxy/" class="article-date">
  <time datetime="2016-01-21T13:27:50.000Z" itemprop="datePublished">2016-01-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/开发笔记/">开发笔记</a>►<a class="article-category-link" href="/categories/开发笔记/Python/">Python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/21/netease-music-app-reversed-proxy/">网易云音乐APP反代开发笔记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>前几个月网易云音乐下架了一批版权音乐，网页端和手机客户端都无法播放。后来博主通过逆向网页端的JavaScript，写了一个<a href="https://github.com/Chion82/163_music_cracker" target="_blank" rel="external">Chrome插件</a>替换页面JS，使得可以播放下架和收费音乐，但最近网易已修复，插件已失效。（不排除是因为网易更新前端代码时重新构建混淆了JS导致我写的patch失效）。本笔记主要记录移动客户端的反向代理破解方案。</p>
<h2 id="项目地址"><a href="#项目地址" class="headerlink" title="项目地址"></a>项目地址</h2><p><a href="https://github.com/Chion82/163-music-unlock" target="_blank" rel="external">https://github.com/Chion82/163-music-unlock</a></p>
<h2 id="关于下架、收费音乐"><a href="#关于下架、收费音乐" class="headerlink" title="关于下架、收费音乐"></a>关于下架、收费音乐</h2><p>网易云音乐上的每首歌都有唯一ID，通过歌曲ID调用API可获得每个资源文件的ID，将资源文件ID加密后可获取到mp3链接地址，从<a href="https://github.com/darknessomi/musicbox" target="_blank" rel="external">网易云音乐命令行版</a>源码中可获得链接拼接方式。经测试，这样拼接出来链接同样适用于下架和付费音乐。从歌曲ID获取资源文件URL的关键代码如下:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#代码来自darknessomi/musicbox</span></div><div class="line">...</div><div class="line"><span class="comment"># 歌曲加密算法, 基于https://github.com/yanunon/NeteaseCloudMusic脚本实现</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypted_id</span><span class="params">(id)</span>:</span></div><div class="line">    magic = bytearray(<span class="string">'3go8&amp;$8*3*3h0k(2)2'</span>)</div><div class="line">    song_id = bytearray(id)</div><div class="line">    magic_len = len(magic)</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(len(song_id)):</div><div class="line">        song_id[i] = song_id[i] ^ magic[i % magic_len]</div><div class="line">    m = hashlib.md5(song_id)</div><div class="line">    result = m.digest().encode(<span class="string">'base64'</span>)[:<span class="number">-1</span>]</div><div class="line">    result = result.replace(<span class="string">'/'</span>, <span class="string">'_'</span>)</div><div class="line">    result = result.replace(<span class="string">'+'</span>, <span class="string">'-'</span>)</div><div class="line">    <span class="keyword">return</span> result</div><div class="line">...</div><div class="line"><span class="comment"># song id --&gt; song url ( details )</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">song_detail</span><span class="params">(self, music_id)</span>:</span></div><div class="line">    action = <span class="string">"http://music.163.com/api/song/detail/?id="</span> + str(music_id) + <span class="string">"&amp;ids=["</span> + str(music_id) + <span class="string">"]"</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        data = self.httpRequest(<span class="string">'GET'</span>, action)</div><div class="line">        <span class="keyword">return</span> data[<span class="string">'songs'</span>]</div><div class="line">    <span class="keyword">except</span>:</div><div class="line">        <span class="keyword">return</span> []</div><div class="line">...</div><div class="line"><span class="comment"># 获取高音质mp3 url</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">geturl</span><span class="params">(song)</span>:</span></div><div class="line">    config = Config()</div><div class="line">    quality = Config().get_item(<span class="string">"music_quality"</span>)</div><div class="line">    <span class="keyword">if</span> song[<span class="string">'hMusic'</span>] <span class="keyword">and</span> quality &lt;= <span class="number">0</span>:</div><div class="line">        music = song[<span class="string">'hMusic'</span>]</div><div class="line">...</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">return</span> song[<span class="string">'mp3Url'</span>], <span class="string">''</span></div><div class="line">...</div><div class="line">    <span class="comment">#拼接最终资源文件URL</span></div><div class="line">    song_id = str(music[<span class="string">'dfsId'</span>])</div><div class="line">    enc_id = encrypted_id(song_id)</div><div class="line">    url = <span class="string">"http://m%s.music.126.net/%s/%s.mp3"</span> % (random.randrange(<span class="number">1</span>, <span class="number">3</span>), enc_id, song_id)</div><div class="line">    <span class="keyword">return</span> url, quality</div></pre></td></tr></table></figure></p>
<h2 id="移动客户端抓包"><a href="#移动客户端抓包" class="headerlink" title="移动客户端抓包"></a>移动客户端抓包</h2><p>在路由器上运行tcpdump抓包，使用wireshark分析出几个关键API，这些API用于网易云音乐移动客户端（IOS）获取歌曲信息。</p>
<ol>
<li><p>获取播放列表详细信息<br>POST: <a href="http://music.163.com/eapi/v3/playlist/detail/" target="_blank" rel="external">http://music.163.com/eapi/v3/playlist/detail/</a><br>该API返回JSON，经JSON viewer解析后部分内容如下：<br><img src="/images/netease-api-2.png" width="200px"><br>上图privileges数组的每个元素中，”fee”, “payed”, “st”等字段分别标示每首音乐的状态。其中0号元素是下架音乐，3号元素的音乐可正常播放，存在不同的参数一目了然。其中”fee”和”payed”和付费歌曲有关。</p>
</li>
<li><p>获取音乐资源URL</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">POST: http://music.163.com/eapi/song/enhance/player/url</div><div class="line">=&gt;</div><div class="line">&#123;&quot;data&quot;:[&#123;&quot;id&quot;:26117507,&quot;url&quot;:&quot;http://m8.music.126.net/20160121231817/b4980525dca8b023c187321115a2463d/ymusic/5e8a/e1af/5a94/bd16133f4ebc8d5a5aaa5a44c6111813.mp3&quot;,&quot;br&quot;:320000,&quot;size&quot;:10722786,&quot;md5&quot;:&quot;bd16133f4ebc8d5a5aaa5a44c6111813&quot;,&quot;code&quot;:200,&quot;expi&quot;:1200,&quot;type&quot;:&quot;mp3&quot;,&quot;gain&quot;:-6.15,&quot;fee&quot;:0,&quot;uf&quot;:null,&quot;payed&quot;:0,&quot;canExtend&quot;:false&#125;],&quot;code&quot;:200&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="Hack-the-World"><a href="#Hack-the-World" class="headerlink" title="Hack the World"></a>Hack the World</h2><p>从抓包结果可知，只需更改几个播放列表的参数，客户端即可播放下架和付费音乐。因此需要架设一个反向代理服务器，使用nginx的sub_filter实现文本替换，nginx的关键配置如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">        listen 80;</div><div class="line">        server_name music.163.com;</div><div class="line">        resolver 114.114.114.114;</div><div class="line">        set $backend_upstream &quot;http://music.163.com&quot;;</div><div class="line"></div><div class="line">        location / &#123;</div><div class="line">               proxy_pass $backend_upstream;</div><div class="line">               proxy_set_header Host $host;</div><div class="line">               proxy_set_header X-Real-IP $remote_addr;</div><div class="line">               proxy_set_header Accept-Encoding &quot;&quot;; #十分重要，默认为gzip encoding，sub_filter无法识别</div><div class="line">               sub_filter &apos;&quot;st&quot;:-200&apos; &apos;&quot;st&quot;:0&apos;;</div><div class="line">               sub_filter &apos;&quot;st&quot;:-100&apos; &apos;&quot;st&quot;:0&apos;;</div><div class="line">               sub_filter &apos;&quot;st&quot;:-1&apos; &apos;&quot;st&quot;:0&apos;;</div><div class="line">               sub_filter &apos;&quot;st&quot;:-2&apos; &apos;&quot;st&quot;:0&apos;;</div><div class="line">               sub_filter &apos;&quot;st&quot;:-3&apos; &apos;&quot;st&quot;:0&apos;;</div><div class="line">               sub_filter &apos;&quot;pl&quot;:0&apos; &apos;&quot;pl&quot;:320000&apos;;</div><div class="line">               sub_filter &apos;&quot;dl&quot;:0&apos; &apos;&quot;dl&quot;:320000&apos;;</div><div class="line">               sub_filter &apos;&quot;fee&quot;:1&apos; &apos;&quot;fee&quot;:0&apos;;</div><div class="line">               sub_filter &apos;&quot;sp&quot;:0&apos; &apos;&quot;sp&quot;:7&apos;;</div><div class="line">               sub_filter &apos;&quot;cp&quot;:0&apos; &apos;&quot;cp&quot;:1&apos;;</div><div class="line">               sub_filter &apos;&quot;subp&quot;:0&apos; &apos;&quot;subp&quot;:1&apos;;</div><div class="line">               sub_filter &apos;&quot;fl&quot;:0&apos; &apos;&quot;fl&quot;:320000&apos;;</div><div class="line">               sub_filter_once off;</div><div class="line">               sub_filter_types *;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        location /eapi/song/enhance/player/url &#123;  #这里是需要重新拼接歌曲URL的代理，稍后将说明</div><div class="line">               proxy_pass http://localhost:5001;</div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>通过几个sub_filter，可将歌曲参数从下架／收费状态更改成普通状态。但是对于下架和收费歌曲，通过 <a href="http://music.163.com/eapi/song/enhance/player/url" target="_blank" rel="external">http://music.163.com/eapi/song/enhance/player/url</a> 这个API无法直接获取到歌曲播放地址，因此需要借助前文提到的URL拼接方法提供新的URL。在清楚歌曲ID加密算法后，在借助Flask的帮助下能快速写出一个API server，在nginx中将相应请求反代到这个API server即可。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.chionlab.moe/2016/01/21/netease-music-app-reversed-proxy/" data-id="ciwkezn2f000tlr2hng01pfuj" class="article-share-link">分享</a>
      
        <a href="http://blog.chionlab.moe/2016/01/21/netease-music-app-reversed-proxy/#disqus_thread" class="article-comment-link">评论</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hack/">hack</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-thunderhack-development-log" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/20/thunderhack-development-log/" class="article-date">
  <time datetime="2016-01-20T12:32:38.000Z" itemprop="datePublished">2016-01-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/开发笔记/">开发笔记</a>►<a class="article-category-link" href="/categories/开发笔记/Python/">Python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/20/thunderhack-development-log/">ThunderHack开发笔记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="关于ThunderHack"><a href="#关于ThunderHack" class="headerlink" title="关于ThunderHack"></a>关于ThunderHack</h2><p>ThunderHack是一个运行于服务端的Python脚本，模拟用户操作迅雷离线平台，同时运行web server，提供网页端UI和API。该工具由维护者提供大容量离线空间，用户只需直接提交源下载地址（magnet/ed2k/http/https/ftp等），可获取迅雷离线服务器的下载地址，实现免费高速下载。<br><a href="https://github.com/Chion82/ThunderHack.git" target="_blank" rel="external">https://github.com/Chion82/ThunderHack.git</a></p>
<h2 id="CLI版（推荐）"><a href="#CLI版（推荐）" class="headerlink" title="CLI版（推荐）"></a>CLI版（推荐）</h2><p>依赖：Python2.7/3.X, aria2<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ sudo pip install xunleishare</div><div class="line">$ xunleishare [-o OUTPUT_SHELL] DOWNLOAD_LINK</div><div class="line">$ ./xunlei_output</div></pre></td></tr></table></figure></p>
<p><a href="https://github.com/Chion82/xunlei_share.git" target="_blank" rel="external">https://github.com/Chion82/xunlei_share.git</a></p>
<h2 id="网页端"><a href="#网页端" class="headerlink" title="网页端"></a>网页端</h2><p><a href="http://syslab.ddns.us/thunder_hack" target="_blank" rel="external">http://syslab.ddns.us/thunder_hack</a></p>
<h2 id="开发笔记"><a href="#开发笔记" class="headerlink" title="开发笔记"></a>开发笔记</h2><p>为什么会突然想造这个轮子？一次登陆迅雷离线网页端顺便F12抓的包，发现网页版的API参数无加密且不复杂，可通过程序模拟请求。</p>
<h3 id="抓包"><a href="#抓包" class="headerlink" title="抓包"></a>抓包</h3><p>从迅雷离线网页端抓取的几个关键API如下：</p>
<ol>
<li><p>BT、magnet查询API</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">GET: http://dynamic.cloud.vip.xunlei.com/interface/url_query?callback=queryUrl&amp;u=magnet%3A%3Fxt%3Durn%3Abtih%3AMPGNCXWJJZ4XMDQRQB2D6XE4I3U7D74K%26dn%3D%255BMGRT%2526Mabors%2BSub%255DGekijouban%2BAno%2BHi%2BMita%2BHana%2Bno%2BNamae%2Bo%2BBokutachi%2Bwa%2BMada%2BShiranai.%2528BDrip%2B1920x1080%2Bx264%2BFLAC%2BAAC%2BGB%2526BIG5%2526JP%2529%26tr%3Dhttp%253A%252F%252F208.67.16.113%253A8000%252Fannounce%26tr%3Dudp%253A%252F%252F208.67.16.113%253A8000%252Fannounce%26tr%3Dhttp%253A%252F%252Ftracker.openbittorrent.com%253A80%252Fannounce%26tr%3Dhttp%253A%252F%252Ftracker.publicbt.com%253A80%252Fannounce%26tr%3Dhttp%253A%252F%252Ftracker.prq.to%252Fannounce%26tr%3Dhttp%253A%252F%252Ftracker.ktxp.com%253A7070%252Fannounce%26tr%3Dhttp%253A%252F%252Ftracker.ktxp.com%253A6868%252Fannounce%26tr%3Dhttp%253A%252F%252Fopen.nyaatorrents.info%253A6544%252Fannounce%26tr%3Dhttp%253A%252F%252Fbtfile.sdo.com%253A6961%252Fannounce%26tr%3Dhttp%253A%252F%252F121.14.98.151%253A9090%252Fannounce&amp;interfrom=task&amp;random=14394337045561054423.7983869016&amp;tcache=1439433717265</div><div class="line">=&gt;</div><div class="line">queryUrl(1,&apos;MPGNCXWJJZ4XMDQRQB2D6XE4I3U7D74K&apos;,&apos;6229928848&apos;,&apos;[MGRT&amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai.(BDrip 1920x1080 x264 FLAC AAC GB&amp;BIG5&amp;JP)&apos;,&apos;0&apos;,new Array(&apos;Scans\\/Scan_00.png&apos;,&apos;Scans\\/Scan_01.png&apos;,&apos;Scans\\/Scan_02.png&apos;,&apos;Scans\\/Scan_03.png&apos;,&apos;Scans\\/Scan_04.png&apos;,&apos;Scans\\/Scan_05.png&apos;,&apos;Scans\\/Scan_06.png&apos;,&apos;Scans\\/Scan_07.png&apos;,&apos;Scans\\/Scan_08.png&apos;,&apos;Scans\\/Scan_09.png&apos;,&apos;Scans\\/Scan_10.png&apos;,&apos;Scans\\/Scan_11.png&apos;,&apos;Scans\\/Scan_12.png&apos;,&apos;Scans\\/Scan_13.png&apos;,&apos;Scans\\/Scan_14.png&apos;,&apos;Scans\\/Scan_15.png&apos;,&apos;Scans\\/Scan_16.png&apos;,&apos;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai. - Audio 5.1.flac&apos;,&apos;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai. - Menu 01(BDrip 1920x1080 x264 AAC).mkv&apos;,&apos;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai. - Menu 02(BDrip 1920x1080 x264 AAC).mkv&apos;,&apos;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai. - NCOP(BDrip 1920x1080 x264 AAC).mkv&apos;,&apos;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai. - SP 01(BDrip 1920x1080 x264 AAC).mkv&apos;,&apos;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai. - SP 02(BDrip 1920x1080 x264 AAC).mkv&apos;,&apos;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai.(BDrip 1920x1080 x264 FLAC AAC).big5.ass&apos;,&apos;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai.(BDrip 1920x1080 x264 FLAC AAC).gb.ass&apos;,&apos;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai.(BDrip 1920x1080 x264 FLAC AAC).mkv&apos;,&apos;[MGRT][13.08.21] 劇場版「あの日見た花の名前を僕達はまだ知らない。」主題歌 - サークルゲーム【期間生産限定アニメ盤】 歌：Galileo Galilei (ALAC+cue+log+png+DVDISO).rar&apos;,&apos;[MGRT][13.08.28] 劇場版「あの日見た花の名前を僕達はまだ知らない。」オリジナル・サウンドトラック  音楽：REMEDIOS (2ALAC+cue+log+png).rar&apos;,&apos;COMPILATION MUSIC.rar&apos;,&apos;Fonts.rar&apos;),new Array(&apos;3.90M&apos;,&apos;4.32M&apos;,&apos;4.38M&apos;,&apos;3.63M&apos;,&apos;4.29M&apos;,&apos;2.82M&apos;,&apos;1.94M&apos;,&apos;3.70M&apos;,&apos;1.98M&apos;,&apos;3.17M&apos;,&apos;3.87M&apos;,&apos;3.99M&apos;,&apos;2.59M&apos;,&apos;2.41M&apos;,&apos;2.56M&apos;,&apos;1.63M&apos;,&apos;22.7M&apos;,&apos;2.20G&apos;,&apos;9.03M&apos;,&apos;2.68M&apos;,&apos;20.9M&apos;,&apos;139M&apos;,&apos;35.4M&apos;,&apos;142K&apos;,&apos;142K&apos;,&apos;2.30G&apos;,&apos;311M&apos;,&apos;416M&apos;,&apos;379M&apos;,&apos;17.7M&apos;),new Array(&apos;4090243&apos;,&apos;4536547&apos;,&apos;4598479&apos;,&apos;3810200&apos;,&apos;4500046&apos;,&apos;2964511&apos;,&apos;2039023&apos;,&apos;3882558&apos;,&apos;2077791&apos;,&apos;3329777&apos;,&apos;4067333&apos;,&apos;4189214&apos;,&apos;2723186&apos;,&apos;2529606&apos;,&apos;2693052&apos;,&apos;1711549&apos;,&apos;23876871&apos;,&apos;2363024548&apos;,&apos;9474807&apos;,&apos;2818296&apos;,&apos;22001218&apos;,&apos;146039473&apos;,&apos;37178662&apos;,&apos;146284&apos;,&apos;146266&apos;,&apos;2469742194&apos;,&apos;326404175&apos;,&apos;436642897&apos;,&apos;397730513&apos;,&apos;18579515&apos;),new Array(&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;1&apos;,&apos;1&apos;,&apos;1&apos;,&apos;1&apos;,&apos;1&apos;,&apos;1&apos;,&apos;1&apos;,&apos;1&apos;,&apos;1&apos;,&apos;1&apos;,&apos;1&apos;,&apos;1&apos;,&apos;1&apos;),new Array(&apos;RAR&apos;,&apos;RAR&apos;,&apos;RAR&apos;,&apos;RAR&apos;,&apos;RAR&apos;,&apos;RAR&apos;,&apos;RAR&apos;,&apos;RAR&apos;,&apos;RAR&apos;,&apos;RAR&apos;,&apos;RAR&apos;,&apos;RAR&apos;,&apos;RAR&apos;,&apos;RAR&apos;,&apos;RAR&apos;,&apos;RAR&apos;,&apos;RAR&apos;,&apos;RAR&apos;,&apos;RMVB&apos;,&apos;RMVB&apos;,&apos;RMVB&apos;,&apos;RMVB&apos;,&apos;RMVB&apos;,&apos;RAR&apos;,&apos;RAR&apos;,&apos;RMVB&apos;,&apos;RAR&apos;,&apos;RAR&apos;,&apos;RAR&apos;,&apos;RAR&apos;),new Array(&apos;0&apos;,&apos;1&apos;,&apos;2&apos;,&apos;3&apos;,&apos;4&apos;,&apos;5&apos;,&apos;6&apos;,&apos;7&apos;,&apos;8&apos;,&apos;9&apos;,&apos;10&apos;,&apos;11&apos;,&apos;12&apos;,&apos;13&apos;,&apos;14&apos;,&apos;15&apos;,&apos;16&apos;,&apos;17&apos;,&apos;18&apos;,&apos;19&apos;,&apos;20&apos;,&apos;21&apos;,&apos;22&apos;,&apos;23&apos;,&apos;24&apos;,&apos;25&apos;,&apos;26&apos;,&apos;27&apos;,&apos;28&apos;,&apos;29&apos;),new Array(&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;,&apos;0&apos;),&apos;14394337045561054423.7983869016&apos;,&apos;0&apos;)</div></pre></td></tr></table></figure>
</li>
<li><p>提交BT、magnet任务到离线空间</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">POST: http://dynamic.cloud.vip.xunlei.com/interface/bt_task_commit?callback=jsonp1439433353636&amp;t=Thu%20Aug%2013%202015%2010:42:05%20GMT+0800%20(HKT)</div><div class="line">Post field:</div><div class="line">uid:208115253</div><div class="line">btname:[MGRT&amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai.(BDrip 1920x1080 x264 FLAC AAC GB&amp;BIG5&amp;JP)</div><div class="line">cid:MPGNCXWJJZ4XMDQRQB2D6XE4I3U7D74K</div><div class="line">goldbean:0</div><div class="line">silverbean:0</div><div class="line">tsize:6229928848</div><div class="line">findex:17_18_19_20_21_22_23_24_25_26_27_28_29_</div><div class="line">size:2363024548_9474807_2818296_22001218_146039473_37178662_146284_146266_2469742194_326404175_436642897_397730513_18579515_</div><div class="line">o_taskid:0</div><div class="line">o_page:task</div><div class="line">class_id:0</div><div class="line">interfrom:task</div><div class="line">verify_code:</div><div class="line">=&gt;</div><div class="line">jsonp1439433353636(&#123;&quot;id&quot;:&quot;1033432253338880&quot;,&quot;avail_space&quot;:&quot;2249634561012829&quot;,&quot;time&quot;:0.42569899559021,&quot;progress&quot;:1&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>提交普通任务(http/ed2k等)</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">GET :http://dynamic.cloud.vip.xunlei.com/interface/task_commit?callback=ret_task&amp;uid=208115253&amp;cid=6269CC18A9B66728C1E5A67ACA7523A424513D76&amp;gcid=B06FE736DADEDBA4364348C779E9CC7DC859F17D&amp;size=1073741824&amp;goldbean=0&amp;silverbean=0&amp;t=Wu.Xia.Setup.V1.1.3.2.Full.Client.part02.rar&amp;url=http%3A%2F%2Fgdl.lixian.vip.xunlei.com%2FWu.Xia.Setup.V1.1.3.2.Full.Client.part02.rar%3Ffid%3DYmnMGKm2ZyjB5aZ6ynUjpCRRPXYAAABAAAAAALBv5zba3tukNkNIx3npzH3IWfF9%26mid%3D666%26threshold%3D150%26tid%3D0AAE0146A6116A4BE5B84EE4F9A3D51B%26srcid%3D6%26verno%3D1%26g%3DB06FE736DADEDBA4364348C779E9CC7DC859F17D%26ui%3D208115253%26s%3D1073741824%26pk%3Dkuaichuan%26ak%3D8%3A0%3A999%3A0%26e%3D1439520556%26ms%3D51200%26ci%3D%26ck%3DE3DAEF800B933F3167A0197646D3B4A0%26at%3D1A3E485B19E9EB13EB8C3F11DD7B599F%26hy%3D1%26n%3D0C32B5BC89281E2A5300B4E7A16F29352E54EEA1FF7351427509ACBC922D16616E11EEE2B0330B34324BB2F3A3417F0400&amp;type=0&amp;o_page=history&amp;o_taskid=0&amp;class_id=0&amp;database=undefined&amp;interfrom=task&amp;verify_code=&amp;time=Thu%20Aug%2013%202015%2010:52:54%20GMT+0800%20(HKT)&amp;noCacheIE=1439434374477</div><div class="line">=&gt;</div><div class="line">ret_task(1,&apos;1033437575386368&apos;,&apos;0.2315080165863&apos;)</div></pre></td></tr></table></figure>
</li>
<li><p>翻页查询任务</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">GET: http://dynamic.cloud.vip.xunlei.com/interface/showtask_unfresh?callback=jsonp1439433877220&amp;t=Thu%20Aug%2013%202015%2010:44:37%20GMT+0800%20(HKT)&amp;type_id=4&amp;page=1&amp;tasknum=30&amp;p=1&amp;interfrom=task</div><div class="line">=&gt;</div><div class="line">queryCid(&apos;6269CC18A9B66728C1E5A67ACA7523A424513D76&apos;, &apos;B06FE736DADEDBA4364348C779E9CC7DC859F17D&apos;, &apos;1073741824&apos;,&apos;2249633487271005&apos;, &apos;Wu.Xia.Setup.V1.1.3.2.Full.Client.part02.rar&apos;, &apos;0&apos;,&apos;0&apos;, 0,&apos;1439434366089947731.337838443&apos;,&apos;rar&apos;,&apos;0&apos;)</div></pre></td></tr></table></figure>
</li>
<li><p>列出BT、magnet任务的文件列表</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">GET: http://dynamic.cloud.vip.xunlei.com/interface/fill_bt_list?callback=fill_bt_list&amp;tid=1033432253338880&amp;infoid=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;g_net=1&amp;p=1&amp;uid=208115253&amp;interfrom=task&amp;noCacheIE=1439433922810</div><div class="line">=&gt;</div><div class="line">fill_bt_list(&#123;&quot;Result&quot;:&#123;&quot;Tid&quot;:&quot;1033432253338880&quot;,&quot;Infoid&quot;:&quot;63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&quot;,&quot;btnum&quot;:&quot;13&quot;,&quot;btpernum&quot;:30,&quot;now_page&quot;:1,&quot;Record&quot;:[&#123;&quot;id&quot;:0,&quot;title&quot;:&quot;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai. - Audio 5.1.flac&quot;,&quot;download_status&quot;:&quot;2&quot;,&quot;cid&quot;:&quot;99C94A8BDC84DCEAFD7356F232557F27FAF81E43&quot;,&quot;size&quot;:&quot;2.20G&quot;,&quot;percent&quot;:100,&quot;taskid&quot;:&quot;1033432253404480&quot;,&quot;icon&quot;:&quot;RAR&quot;,&quot;livetime&quot;:&quot;365\u5929&quot;,&quot;downurl&quot;:&quot;http:\/\/gdl.lixian.vip.xunlei.com\/download?fid=mclKi9yE3Or9c1byMlV\/J\/r4HkOk5NiMAAAAAM0QeeQUdvGKWARXXwfMCh0lt934&amp;mid=666&amp;threshold=150&amp;tid=493E66D0ECA261B41AA97E8ECE0561AA&amp;srcid=4&amp;verno=1&amp;g=CD1079E41476F18A5804575F07CC0A1D25B7DDF8&amp;scn=t18&amp;i=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;t=6&amp;ui=208115253&amp;ti=1033432253404480&amp;s=2363024548&amp;m=0&amp;n=013A7CA30D54264D61035E962C205375623C768134696A6F7503508A7F416E6F202958C4126974612029508A3E206E6F202F50893E65206F20235E8F2A746163680811933E204D61640011B7376972616E0058CA7F2D20417505588B7F352E312E075D853C00000000&amp;ih=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;fi=17&amp;pi=1033432253338880&amp;ff=0&amp;co=B07951D481443FF3B125AF546C501605&amp;cm=1&amp;pk=lixian&amp;ak=1:0:6:4&amp;e=1447209695&amp;ms=10485760&amp;ck=601902F2D83C9A97ED4E6FAC83FA4010&amp;at=F2191321811F9920CE166300279ABA1B&quot;,&quot;vod&quot;:&quot;0&quot;,&quot;cdn&quot;:[],&quot;format_img&quot;:&quot;other&quot;,&quot;filesize&quot;:&quot;2363024548&quot;,&quot;verify&quot;:&quot;ca609506d44b624fdd0c117da1f843d0&quot;,&quot;url&quot;:&quot;bt:\/\/63CCD15EC94E79760E1180743F5C9C46E9F1FF8A\/17&quot;,&quot;openformat&quot;:&quot;&quot;,&quot;ext&quot;:&quot;flac&quot;,&quot;dirtitle&quot;:&quot;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai. - Audio 5.1.flac&quot;,&quot;is_blocked&quot;:0&#125;,&#123;&quot;id&quot;:1,&quot;title&quot;:&quot;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai. - Menu 01(BDrip 1920x1080 x264 AAC).mkv&quot;,&quot;download_status&quot;:&quot;2&quot;,&quot;cid&quot;:&quot;8B88BA5C635F9E8606A1059AC594A5B62FC5898D&quot;,&quot;size&quot;:&quot;9.03M&quot;,&quot;percent&quot;:100,&quot;taskid&quot;:&quot;1033432253470016&quot;,&quot;icon&quot;:&quot;RMVB&quot;,&quot;livetime&quot;:&quot;365\u5929&quot;,&quot;downurl&quot;:&quot;http:\/\/gdl.lixian.vip.xunlei.com\/download?fid=i4i6XGNfnoYGoQWaxZSlti\/FiY33kpAAAAAAALqMOWwoV6AQ5zopMFal0RP5VQpE&amp;mid=666&amp;threshold=150&amp;tid=B917B3233B55EAA7E6293CEB10D4DA53&amp;srcid=4&amp;verno=1&amp;g=BA8C396C2857A010E73A293056A5D113F9550A44&amp;scn=u2&amp;i=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;t=6&amp;ui=208115253&amp;ti=1033432253470016&amp;s=9474807&amp;m=0&amp;n=013A7CA30D54264D61035E962C205375623C768134696A6F7503508A7F416E6F202958C4126974612029508A3E206E6F202F50893E65206F20235E8F2A746163680811933E204D61640011B7376972616E0058CA7F2D204D650F44C46F312842441358947F313932301900D467302078325705C41E4143292E0C5A925F00000000&amp;ih=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;fi=18&amp;pi=1033432253338880&amp;ff=0&amp;co=8046D92536CB73B6ACA5CDD2E6647C1C&amp;cm=1&amp;pk=lixian&amp;ak=1:0:6:4&amp;e=1447209695&amp;ms=10485760&amp;ck=601902F2D83C9A97ED4E6FAC83FA4010&amp;at=63500B46C3C5A833E454AFE1824E19C4&quot;,&quot;vod&quot;:&quot;1&quot;,&quot;cdn&quot;:[],&quot;format_img&quot;:&quot;video&quot;,&quot;filesize&quot;:&quot;9474807&quot;,&quot;verify&quot;:&quot;f87c5821789304dce494c4430ae5717f&quot;,&quot;url&quot;:&quot;bt:\/\/63CCD15EC94E79760E1180743F5C9C46E9F1FF8A\/18&quot;,&quot;openformat&quot;:&quot;movie&quot;,&quot;ext&quot;:&quot;mkv&quot;,&quot;dirtitle&quot;:&quot;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai. - Menu 01(BDrip 1920x1080 x264 AAC).mkv&quot;,&quot;is_blocked&quot;:0&#125;,&#123;&quot;id&quot;:2,&quot;title&quot;:&quot;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai. - Menu 02(BDrip 1920x1080 x264 AAC).mkv&quot;,&quot;download_status&quot;:&quot;2&quot;,&quot;cid&quot;:&quot;1B9D7D66B87C8B809EE1F7F6844C5E237C1FF5DF&quot;,&quot;size&quot;:&quot;2.68M&quot;,&quot;percent&quot;:100,&quot;taskid&quot;:&quot;1033432253535552&quot;,&quot;icon&quot;:&quot;RMVB&quot;,&quot;livetime&quot;:&quot;365\u5929&quot;,&quot;downurl&quot;:&quot;http:\/\/gdl.lixian.vip.xunlei.com\/download?fid=G519Zrh8i4Ce4ff2hExeI3wf9d\/4ACsAAAAAAODuVHjC9g9eAQ0WVSutnyDl\/wZ\/&amp;mid=666&amp;threshold=150&amp;tid=8449710F1FB9C13B236A932BD0C55BFC&amp;srcid=4&amp;verno=1&amp;g=E0EE5478C2F60F5E010D16552BAD9F20E5FF067F&amp;scn=u1&amp;i=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;t=6&amp;ui=208115253&amp;ti=1033432253535552&amp;s=2818296&amp;m=0&amp;n=013A7CA30D54264D61035E962C205375623C768134696A6F7503508A7F416E6F202958C4126974612029508A3E206E6F202F50893E65206F20235E8F2A746163680811933E204D61640011B7376972616E0058CA7F2D204D650F44C46F322842441358947F313932301900D467302078325705C41E4143292E0C5A925F00000000&amp;ih=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;fi=19&amp;pi=1033432253338880&amp;ff=0&amp;co=0B4508291E892F59357B13FFECFC36CA&amp;cm=1&amp;pk=lixian&amp;ak=1:0:6:4&amp;e=1447209695&amp;ms=10485760&amp;ck=601902F2D83C9A97ED4E6FAC83FA4010&amp;at=614C54E08D0B8BF4975CDAD173051D7F&quot;,&quot;vod&quot;:&quot;1&quot;,&quot;cdn&quot;:[],&quot;format_img&quot;:&quot;video&quot;,&quot;filesize&quot;:&quot;2818296&quot;,&quot;verify&quot;:&quot;f6a67416abd94e12789c8975abb3af3c&quot;,&quot;url&quot;:&quot;bt:\/\/63CCD15EC94E79760E1180743F5C9C46E9F1FF8A\/19&quot;,&quot;openformat&quot;:&quot;movie&quot;,&quot;ext&quot;:&quot;mkv&quot;,&quot;dirtitle&quot;:&quot;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai. - Menu 02(BDrip 1920x1080 x264 AAC).mkv&quot;,&quot;is_blocked&quot;:0&#125;,&#123;&quot;id&quot;:3,&quot;title&quot;:&quot;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai. - NCOP(BDrip 1920x1080 x264 AAC).mkv&quot;,&quot;download_status&quot;:&quot;2&quot;,&quot;cid&quot;:&quot;D9688AA52D48BB24C6CEB4847C17E2FBBEDD6963&quot;,&quot;size&quot;:&quot;20.9M&quot;,&quot;percent&quot;:100,&quot;taskid&quot;:&quot;1033432253601088&quot;,&quot;icon&quot;:&quot;RMVB&quot;,&quot;livetime&quot;:&quot;365\u5929&quot;,&quot;downurl&quot;:&quot;http:\/\/gdl.lixian.vip.xunlei.com\/download?fid=2WiKpS1IuyTGzrSEfBfi+77daWNCtk8BAAAAAGDI6XLMe8VwWyjM2sYD8ZBPeXFp&amp;mid=666&amp;threshold=150&amp;tid=B4071273C65DB771E13977D953D099AC&amp;srcid=4&amp;verno=1&amp;g=60C8E972CC7BC5705B28CCDAC603F1904F797169&amp;scn=u2&amp;i=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;t=6&amp;ui=208115253&amp;ti=1033432253601088&amp;s=22001218&amp;m=0&amp;n=013A7CA30D54264D61035E962C205375623C768134696A6F7503508A7F416E6F202958C4126974612029508A3E206E6F202F50893E65206F20235E8F2A746163680811933E204D61640011B7376972616E0058CA7F2D204E432E61CC1D447269704100DD6D307831305901C427323634202070A7762E6D6B76&amp;ih=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;fi=20&amp;pi=1033432253338880&amp;ff=0&amp;co=89D0B0F90BDB5952CFE0FBE8288D2DDC&amp;cm=1&amp;pk=lixian&amp;ak=1:0:6:4&amp;e=1447209695&amp;ms=10485760&amp;ck=601902F2D83C9A97ED4E6FAC83FA4010&amp;at=1B78AFF7AE5A243001937C0530A8ADB7&quot;,&quot;vod&quot;:&quot;1&quot;,&quot;cdn&quot;:[],&quot;format_img&quot;:&quot;video&quot;,&quot;filesize&quot;:&quot;22001218&quot;,&quot;verify&quot;:&quot;ba0671b7f5bac7ef4a80559408ff5257&quot;,&quot;url&quot;:&quot;bt:\/\/63CCD15EC94E79760E1180743F5C9C46E9F1FF8A\/20&quot;,&quot;openformat&quot;:&quot;movie&quot;,&quot;ext&quot;:&quot;mkv&quot;,&quot;dirtitle&quot;:&quot;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai. - NCOP(BDrip 1920x1080 x264 AAC).mkv&quot;,&quot;is_blocked&quot;:0&#125;,&#123;&quot;id&quot;:4,&quot;title&quot;:&quot;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai. - SP 01(BDrip 1920x1080 x264 AAC).mkv&quot;,&quot;download_status&quot;:&quot;2&quot;,&quot;cid&quot;:&quot;A03B272727AB66B4E6B1146810DDC637DF259AEE&quot;,&quot;size&quot;:&quot;139M&quot;,&quot;percent&quot;:100,&quot;taskid&quot;:&quot;1033432253666624&quot;,&quot;icon&quot;:&quot;RMVB&quot;,&quot;livetime&quot;:&quot;365\u5929&quot;,&quot;downurl&quot;:&quot;http:\/\/gdl.lixian.vip.xunlei.com\/download?fid=oDsnJyerZrTmsRRoEN3GN98lmu6xYrQIAAAAAGLpp9cenPuTuu2gf2ScgFMP9sH\/&amp;mid=666&amp;threshold=150&amp;tid=CE317301A02824D3A70B07E0A3837C98&amp;srcid=4&amp;verno=1&amp;g=62E9A7D71E9CFB93BAEDA07F649C80530FF6C1FF&amp;scn=t36&amp;i=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;t=6&amp;ui=208115253&amp;ti=1033432253666624&amp;s=146039473&amp;m=0&amp;n=013A7CA30D54264D61035E962C205375623C768134696A6F7503508A7F416E6F202958C4126974612029508A3E206E6F202F50893E65206F20235E8F2A746163680811933E204D61640011B7376972616E0058CA7F2D2053504101D577424472691111D566323078315109D47F783236344170A51C292E6D6B1731E45F00000000&amp;ih=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;fi=21&amp;pi=1033432253338880&amp;ff=0&amp;co=F9C243ABFCA7B155387966DEA5F30B94&amp;cm=1&amp;pk=lixian&amp;ak=1:0:6:4&amp;e=1447209695&amp;ms=10485760&amp;ck=601902F2D83C9A97ED4E6FAC83FA4010&amp;at=E31070775C737855FF303FC85840FCEB&quot;,&quot;vod&quot;:&quot;1&quot;,&quot;cdn&quot;:[],&quot;format_img&quot;:&quot;video&quot;,&quot;filesize&quot;:&quot;146039473&quot;,&quot;verify&quot;:&quot;ba279489d6b6ee5f1dd19920bd6b83eb&quot;,&quot;url&quot;:&quot;bt:\/\/63CCD15EC94E79760E1180743F5C9C46E9F1FF8A\/21&quot;,&quot;openformat&quot;:&quot;movie&quot;,&quot;ext&quot;:&quot;mkv&quot;,&quot;dirtitle&quot;:&quot;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai. - SP 01(BDrip 1920x1080 x264 AAC).mkv&quot;,&quot;is_blocked&quot;:0&#125;,&#123;&quot;id&quot;:5,&quot;title&quot;:&quot;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai. - SP 02(BDrip 1920x1080 x264 AAC).mkv&quot;,&quot;download_status&quot;:&quot;2&quot;,&quot;cid&quot;:&quot;B29B36F826CB965DB158A32082D7532D27FF906D&quot;,&quot;size&quot;:&quot;35.4M&quot;,&quot;percent&quot;:100,&quot;taskid&quot;:&quot;1033432253732160&quot;,&quot;icon&quot;:&quot;RMVB&quot;,&quot;livetime&quot;:&quot;365\u5929&quot;,&quot;downurl&quot;:&quot;http:\/\/gdl.lixian.vip.xunlei.com\/download?fid=sps2+CbLll2xWKMggtdTLSf\/kG0mTTcCAAAAAL\/iLScbZ7YtJhoaD4OTklAS\/Mlr&amp;mid=666&amp;threshold=150&amp;tid=3D42AABF47FD03964F44D060361AFF9B&amp;srcid=4&amp;verno=1&amp;g=BFE22D271B67B62D261A1A0F8393925012FCC96B&amp;scn=u2&amp;i=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;t=6&amp;ui=208115253&amp;ti=1033432253732160&amp;s=37178662&amp;m=0&amp;n=013A7CA30D54264D61035E962C205375623C768134696A6F7503508A7F416E6F202958C4126974612029508A3E206E6F202F50893E65206F20235E8F2A746163680811933E204D61640011B7376972616E0058CA7F2D2053504101D677424472691111D566323078315109D47F783236344170A51C292E6D6B1731E45F00000000&amp;ih=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;fi=22&amp;pi=1033432253338880&amp;ff=0&amp;co=889A413CD4946B4AADC203633FB8C90F&amp;cm=1&amp;pk=lixian&amp;ak=1:0:6:4&amp;e=1447209695&amp;ms=10485760&amp;ck=601902F2D83C9A97ED4E6FAC83FA4010&amp;at=1857D940BD6E1F36910AD27BDF4C1586&quot;,&quot;vod&quot;:&quot;1&quot;,&quot;cdn&quot;:[],&quot;format_img&quot;:&quot;video&quot;,&quot;filesize&quot;:&quot;37178662&quot;,&quot;verify&quot;:&quot;498d1349691a6f7ac403b77e063969c2&quot;,&quot;url&quot;:&quot;bt:\/\/63CCD15EC94E79760E1180743F5C9C46E9F1FF8A\/22&quot;,&quot;openformat&quot;:&quot;movie&quot;,&quot;ext&quot;:&quot;mkv&quot;,&quot;dirtitle&quot;:&quot;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai. - SP 02(BDrip 1920x1080 x264 AAC).mkv&quot;,&quot;is_blocked&quot;:0&#125;,&#123;&quot;id&quot;:6,&quot;title&quot;:&quot;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai.(BDrip 1920x1080 x264 FLAC AAC).big5.ass&quot;,&quot;download_status&quot;:&quot;2&quot;,&quot;cid&quot;:&quot;58040A73363D851B245503D2942F8DB4D69CAD5F&quot;,&quot;size&quot;:&quot;142K&quot;,&quot;percent&quot;:100,&quot;taskid&quot;:&quot;1033432253797696&quot;,&quot;icon&quot;:&quot;RAR&quot;,&quot;livetime&quot;:&quot;365\u5929&quot;,&quot;downurl&quot;:&quot;http:\/\/gdl.lixian.vip.xunlei.com\/download?fid=WAQKczY9hRskVQPSlC+NtNacrV9sOwIAAAAAAPkWnP+FfMcK8unvPXNu3uGFMcYF&amp;mid=666&amp;threshold=150&amp;tid=779661D8252B842B5C5980E551F510AE&amp;srcid=4&amp;verno=1&amp;g=F9169CFF857CC70AF2E9EF3D736EDEE18531C605&amp;scn=u1&amp;i=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;t=6&amp;ui=208115253&amp;ti=1033432253797696&amp;s=146284&amp;m=0&amp;n=013A7CA30D54264D61035E962C205375623C768134696A6F7503508A7F416E6F202958C4126974612029508A3E206E6F202F50893E65206F20235E8F2A746163680811933E204D61640011B7376972616E0058CA77424472691111D566323078315109D47F783236344177A81E432041412218CA3D6967352E0042975F00000000&amp;ih=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;fi=23&amp;pi=1033432253338880&amp;ff=0&amp;co=D1601A52F60DA5C28F156B4C36BAADC9&amp;cm=1&amp;pk=lixian&amp;ak=1:0:6:4&amp;e=1447209695&amp;ms=10485760&amp;ck=601902F2D83C9A97ED4E6FAC83FA4010&amp;at=BD2805F1A23E8A3E97F118C54D4AF218&quot;,&quot;vod&quot;:&quot;0&quot;,&quot;cdn&quot;:[],&quot;format_img&quot;:&quot;other&quot;,&quot;filesize&quot;:&quot;146284&quot;,&quot;verify&quot;:&quot;9b12510b53c14701a1a932e3f4efc5c2&quot;,&quot;url&quot;:&quot;bt:\/\/63CCD15EC94E79760E1180743F5C9C46E9F1FF8A\/23&quot;,&quot;openformat&quot;:&quot;&quot;,&quot;ext&quot;:&quot;ass&quot;,&quot;dirtitle&quot;:&quot;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai.(BDrip 1920x1080 x264 FLAC AAC).big5.ass&quot;,&quot;is_blocked&quot;:0&#125;,&#123;&quot;id&quot;:7,&quot;title&quot;:&quot;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai.(BDrip 1920x1080 x264 FLAC AAC).gb.ass&quot;,&quot;download_status&quot;:&quot;2&quot;,&quot;cid&quot;:&quot;B6C5245A9303571FEC5F448504FA2A14D7EFF5A6&quot;,&quot;size&quot;:&quot;142K&quot;,&quot;percent&quot;:100,&quot;taskid&quot;:&quot;1033432253863232&quot;,&quot;icon&quot;:&quot;RAR&quot;,&quot;livetime&quot;:&quot;365\u5929&quot;,&quot;downurl&quot;:&quot;http:\/\/gdl.lixian.vip.xunlei.com\/download?fid=tsUkWpMDVx\/sX0SFBPoqFNfv9aZaOwIAAAAAAPqH9eNTUTK05pyR5gRKcTSOziAj&amp;mid=666&amp;threshold=150&amp;tid=A92E865C2B13D776FDEEC88A1A78C26B&amp;srcid=4&amp;verno=1&amp;g=FA87F5E3535132B4E69C91E6044A71348ECE2023&amp;scn=c14&amp;i=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;t=6&amp;ui=208115253&amp;ti=1033432253863232&amp;s=146266&amp;m=0&amp;n=013A7CA30D54264D61035E962C205375623C768134696A6F7503508A7F416E6F202958C4126974612029508A3E206E6F202F50893E65206F20235E8F2A746163680811933E204D61640011B7376972616E0058CA77424472691111D566323078315109D47F783236344177A81E432041412218CA38622E61731231E45F00000000&amp;ih=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;fi=24&amp;pi=1033432253338880&amp;ff=0&amp;co=7B9E3B8DECBE1272C5AF0F374152C178&amp;cm=1&amp;pk=lixian&amp;ak=1:0:6:4&amp;e=1447209695&amp;ms=10485760&amp;ck=601902F2D83C9A97ED4E6FAC83FA4010&amp;at=549524CF2A45282C5E3B6942EBEA8C83&quot;,&quot;vod&quot;:&quot;0&quot;,&quot;cdn&quot;:[],&quot;format_img&quot;:&quot;other&quot;,&quot;filesize&quot;:&quot;146266&quot;,&quot;verify&quot;:&quot;37e0ce7c27c96aa71cf359f6a571e0e0&quot;,&quot;url&quot;:&quot;bt:\/\/63CCD15EC94E79760E1180743F5C9C46E9F1FF8A\/24&quot;,&quot;openformat&quot;:&quot;&quot;,&quot;ext&quot;:&quot;ass&quot;,&quot;dirtitle&quot;:&quot;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai.(BDrip 1920x1080 x264 FLAC AAC).gb.ass&quot;,&quot;is_blocked&quot;:0&#125;,&#123;&quot;id&quot;:8,&quot;title&quot;:&quot;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai.(BDrip 1920x1080 x264 FLAC AAC).mkv&quot;,&quot;download_status&quot;:&quot;2&quot;,&quot;cid&quot;:&quot;BDE1E4C2E445E03AFE12365C342C425116340423&quot;,&quot;size&quot;:&quot;2.30G&quot;,&quot;percent&quot;:100,&quot;taskid&quot;:&quot;1033432253928768&quot;,&quot;icon&quot;:&quot;RMVB&quot;,&quot;livetime&quot;:&quot;365\u5929&quot;,&quot;downurl&quot;:&quot;http:\/\/gdl.lixian.vip.xunlei.com\/download?fid=veHkwuRF4Dr+EjZcNCxCURY0BCNyRjWTAAAAACMhW\/VIu9RrN1HfSQ3yhtpbeBdO&amp;mid=666&amp;threshold=150&amp;tid=4FE3E9C81AAD65CFE1889B80C14E7351&amp;srcid=4&amp;verno=1&amp;g=23215BF548BBD46B3751DF490DF286DA5B78174E&amp;scn=u2&amp;i=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;t=6&amp;ui=208115253&amp;ti=1033432253928768&amp;s=2469742194&amp;m=0&amp;n=013A7CA30D54264D61035E962C205375623C768134696A6F7503508A7F416E6F202958C4126974612029508A3E206E6F202F50893E65206F20235E8F2A746163680811933E204D61640011B7376972616E0058CA77424472691111D566323078315109D47F783236344177A81E432041412218CA326B760000&amp;ih=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;fi=25&amp;pi=1033432253338880&amp;ff=0&amp;co=4B093BF041312F70C0327DB4D9D745E3&amp;cm=1&amp;pk=lixian&amp;ak=1:0:6:4&amp;e=1447209695&amp;ms=10485760&amp;ck=601902F2D83C9A97ED4E6FAC83FA4010&amp;at=FCA839D230AF7BF499A48287C6FE6361&quot;,&quot;vod&quot;:&quot;1&quot;,&quot;cdn&quot;:[],&quot;format_img&quot;:&quot;video&quot;,&quot;filesize&quot;:&quot;2469742194&quot;,&quot;verify&quot;:&quot;8e99bf5f12b3aae8371ecaa5e2294cae&quot;,&quot;url&quot;:&quot;bt:\/\/63CCD15EC94E79760E1180743F5C9C46E9F1FF8A\/25&quot;,&quot;openformat&quot;:&quot;movie&quot;,&quot;ext&quot;:&quot;mkv&quot;,&quot;dirtitle&quot;:&quot;[MGRT&amp;amp;Mabors Sub]Gekijouban Ano Hi Mita Hana no Namae o Bokutachi wa Mada Shiranai.(BDrip 1920x1080 x264 FLAC AAC).mkv&quot;,&quot;is_blocked&quot;:0&#125;,&#123;&quot;id&quot;:9,&quot;title&quot;:&quot;[MGRT][13.08.21] \u5287\u5834\u7248\u300c\u3042\u306e\u65e5\u898b\u305f\u82b1\u306e\u540d\u524d\u3092\u50d5\u9054\u306f\u307e\u3060\u77e5\u3089\u306a\u3044\u3002\u300d\u4e3b\u984c\u6b4c - \u30b5\u30fc\u30af\u30eb\u30b2\u30fc\u30e0\u3010\u671f\u9593\u751f\u7523\u9650\u5b9a\u30a2\u30cb\u30e1\u76e4\u3011 \u6b4c\uff1aGalileo Galilei (ALAC+cue+log+png+DVDISO).rar&quot;,&quot;download_status&quot;:&quot;2&quot;,&quot;cid&quot;:&quot;C0466CBD1B0D6B7A68D7D0381BE33FFAA40268FD&quot;,&quot;size&quot;:&quot;311M&quot;,&quot;percent&quot;:100,&quot;taskid&quot;:&quot;1033432253994304&quot;,&quot;icon&quot;:&quot;RAR&quot;,&quot;livetime&quot;:&quot;365\u5929&quot;,&quot;downurl&quot;:&quot;http:\/\/gdl.lixian.vip.xunlei.com\/download?fid=wEZsvRsNa3po19A4G+M\/+qQCaP1PiHQTAAAAAAyccZr4L96XOemFf+gPmdBnVNkD&amp;mid=666&amp;threshold=150&amp;tid=1718B0786966239C73B33F3A785E6EDB&amp;srcid=4&amp;verno=1&amp;g=0C9C719AF82FDE9739E9857FE80F99D06754D903&amp;scn=u2&amp;i=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;t=6&amp;ui=208115253&amp;ti=1033432253994304&amp;s=326404175&amp;m=0&amp;n=013A7CA30D545D5B31521FD4672E32315D41B545D7F6B0E6A1D99546FBCEC8D5D2EB955BE4A8A4CEC39AF654FBF28357DF3E952BFBDEA4C0D6CB950DFBCAA4A4A1C2905D89F7EE7DB88911C97FA5B5A960C49E41B4A5B2A960C4D145E1C6DAE967A8CB4A3DCFDEB6A8C4934194A5E1B150C08EC4E7E8A3BA47005D8D33656F2047005D8D3365692028207DA51C2B6375654A5D8B382B706E674A75B21B49534F294F43852D00000000&amp;ih=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;fi=26&amp;pi=1033432253338880&amp;ff=0&amp;co=B3328ED373BAC2FF1024FC7FA827030F&amp;cm=1&amp;pk=lixian&amp;ak=1:0:6:4&amp;e=1447209695&amp;ms=10485760&amp;ck=601902F2D83C9A97ED4E6FAC83FA4010&amp;at=B8D80E30FE9B3484F034C1817B6184FE&quot;,&quot;vod&quot;:&quot;0&quot;,&quot;cdn&quot;:[],&quot;format_img&quot;:&quot;rar&quot;,&quot;filesize&quot;:&quot;326404175&quot;,&quot;verify&quot;:&quot;baf437596d3fc8579a37c83b3cf221c3&quot;,&quot;url&quot;:&quot;bt:\/\/63CCD15EC94E79760E1180743F5C9C46E9F1FF8A\/26&quot;,&quot;openformat&quot;:&quot;rar&quot;,&quot;ext&quot;:&quot;rar&quot;,&quot;dirtitle&quot;:&quot;[MGRT][13.08.21] \u5287\u5834\u7248\u300c\u3042\u306e\u65e5\u898b\u305f\u82b1\u306e\u540d\u524d\u3092\u50d5\u9054\u306f\u307e\u3060\u77e5\u3089\u306a\u3044\u3002\u300d\u4e3b\u984c\u6b4c - \u30b5\u30fc\u30af\u30eb\u30b2\u30fc\u30e0\u3010\u671f\u9593\u751f\u7523\u9650\u5b9a\u30a2\u30cb\u30e1\u76e4\u3011 \u6b4c\uff1aGalileo Galilei (ALAC+cue+log+png+DVDISO).rar&quot;,&quot;is_blocked&quot;:0&#125;,&#123;&quot;id&quot;:10,&quot;title&quot;:&quot;[MGRT][13.08.28] \u5287\u5834\u7248\u300c\u3042\u306e\u65e5\u898b\u305f\u82b1\u306e\u540d\u524d\u3092\u50d5\u9054\u306f\u307e\u3060\u77e5\u3089\u306a\u3044\u3002\u300d\u30aa\u30ea\u30b8\u30ca\u30eb\u30fb\u30b5\u30a6\u30f3\u30c9\u30c8\u30e9\u30c3\u30af  \u97f3\u697d\uff1aREMEDIOS (2ALAC+cue+log+png).rar&quot;,&quot;download_status&quot;:&quot;2&quot;,&quot;cid&quot;:&quot;CAF507BFEE8196790C8EE2792FEBB3E5F388AD8E&quot;,&quot;size&quot;:&quot;416M&quot;,&quot;percent&quot;:100,&quot;taskid&quot;:&quot;1033432254059840&quot;,&quot;icon&quot;:&quot;RAR&quot;,&quot;livetime&quot;:&quot;365\u5929&quot;,&quot;downurl&quot;:&quot;http:\/\/gdl.lixian.vip.xunlei.com\/download?fid=yvUHv+6BlnkMjuJ5L+uz5fOIrY5RpAYaAAAAAAoMmWGcbjxRxE0lO1jOQuDQ0NjK&amp;mid=666&amp;threshold=150&amp;tid=9688E18D6FEFC21A44AE91EBADF72319&amp;srcid=4&amp;verno=1&amp;g=0A0C99619C6E3C51C44D253B58CE42E0D0D0D8CA&amp;scn=u2&amp;i=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;t=6&amp;ui=208115253&amp;ti=1033432254059840&amp;s=436642897&amp;m=0&amp;n=013A7CA30D545D5B31521FD4672E32385D41B545D7F6B0E6A1D99546FBCEC8D5D2EB955BE4A8A4CEC39AF654FBF28357DF3E952BFBDEA4C0D6CB950DFBCAA4A4A1C2905DFAAAA5EAA5D9942EFAEB8139A7589451FAA6A5F3A5A8942CFAE9A5C3A5CE11C48DF49853A3DB63A1124544494F3211CC6D414C41434A52913A2B6C6F674A418A38292E72611331E45F00000000&amp;ih=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;fi=27&amp;pi=1033432253338880&amp;ff=0&amp;co=BA5C3D395BA72264D88E28AA2F830C15&amp;cm=1&amp;pk=lixian&amp;ak=1:0:6:4&amp;e=1447209695&amp;ms=10485760&amp;ck=601902F2D83C9A97ED4E6FAC83FA4010&amp;at=55AFB0FBED521F5190BEEB103739B7F0&quot;,&quot;vod&quot;:&quot;0&quot;,&quot;cdn&quot;:[],&quot;format_img&quot;:&quot;rar&quot;,&quot;filesize&quot;:&quot;436642897&quot;,&quot;verify&quot;:&quot;21f40dbe89d38e1f73048e25542313c7&quot;,&quot;url&quot;:&quot;bt:\/\/63CCD15EC94E79760E1180743F5C9C46E9F1FF8A\/27&quot;,&quot;openformat&quot;:&quot;rar&quot;,&quot;ext&quot;:&quot;rar&quot;,&quot;dirtitle&quot;:&quot;[MGRT][13.08.28] \u5287\u5834\u7248\u300c\u3042\u306e\u65e5\u898b\u305f\u82b1\u306e\u540d\u524d\u3092\u50d5\u9054\u306f\u307e\u3060\u77e5\u3089\u306a\u3044\u3002\u300d\u30aa\u30ea\u30b8\u30ca\u30eb\u30fb\u30b5\u30a6\u30f3\u30c9\u30c8\u30e9\u30c3\u30af  \u97f3\u697d\uff1aREMEDIOS (2ALAC+cue+log+png).rar&quot;,&quot;is_blocked&quot;:0&#125;,&#123;&quot;id&quot;:11,&quot;title&quot;:&quot;COMPILATION MUSIC.rar&quot;,&quot;download_status&quot;:&quot;2&quot;,&quot;cid&quot;:&quot;E2E717DA7A121A9ADE4EC07F942D0629F619CA48&quot;,&quot;size&quot;:&quot;379M&quot;,&quot;percent&quot;:100,&quot;taskid&quot;:&quot;1033432254125376&quot;,&quot;icon&quot;:&quot;RAR&quot;,&quot;livetime&quot;:&quot;365\u5929&quot;,&quot;downurl&quot;:&quot;http:\/\/gdl.lixian.vip.xunlei.com\/download?fid=4ucX2noSGpreTsB\/lC0GKfYZykjR4rQXAAAAAPcL77QMfZKZQ3\/UjmC\/3PfYfwT4&amp;mid=666&amp;threshold=150&amp;tid=140792B8B9FDBD3D9883D38634532C7F&amp;srcid=4&amp;verno=1&amp;g=F70BEFB40C7D9299437FD48E60BFDCF7D87F04F8&amp;scn=u2&amp;i=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;t=6&amp;ui=208115253&amp;ti=1033432254125376&amp;s=397730513&amp;m=0&amp;n=01227EA90F494C4154287EAA7F4D555349221F963E72000000&amp;ih=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;fi=28&amp;pi=1033432253338880&amp;ff=0&amp;co=9191E0BE47AF5E75280AF8D3C45725CB&amp;cm=1&amp;pk=lixian&amp;ak=1:0:6:4&amp;e=1447209695&amp;ms=10485760&amp;ck=601902F2D83C9A97ED4E6FAC83FA4010&amp;at=C8A9FBFE2116F272CE722B5D25AAC2CF&quot;,&quot;vod&quot;:&quot;0&quot;,&quot;cdn&quot;:[],&quot;format_img&quot;:&quot;rar&quot;,&quot;filesize&quot;:&quot;397730513&quot;,&quot;verify&quot;:&quot;00f7b749c39934c8aa438ed10b4ce115&quot;,&quot;url&quot;:&quot;bt:\/\/63CCD15EC94E79760E1180743F5C9C46E9F1FF8A\/28&quot;,&quot;openformat&quot;:&quot;rar&quot;,&quot;ext&quot;:&quot;rar&quot;,&quot;dirtitle&quot;:&quot;COMPILATION MUSIC.rar&quot;,&quot;is_blocked&quot;:0&#125;,&#123;&quot;id&quot;:12,&quot;title&quot;:&quot;Fonts.rar&quot;,&quot;download_status&quot;:&quot;2&quot;,&quot;cid&quot;:&quot;75F5BA6F476120B3663BB96F460D39C337111440&quot;,&quot;size&quot;:&quot;17.7M&quot;,&quot;percent&quot;:100,&quot;taskid&quot;:&quot;1033432254190912&quot;,&quot;icon&quot;:&quot;RAR&quot;,&quot;livetime&quot;:&quot;365\u5929&quot;,&quot;downurl&quot;:&quot;http:\/\/gdl.lixian.vip.xunlei.com\/download?fid=dfW6b0dhILNmO7lvRg05wzcRFEA7gBsBAAAAAHnPF0NBEx0oMYs70Hu9Wqg\/a0Q+&amp;mid=666&amp;threshold=150&amp;tid=CE4019E6D03E3A16451051D09D531008&amp;srcid=4&amp;verno=1&amp;g=79CF174341131D28318B3BD07BBD5AA83F6B443E&amp;scn=u2&amp;i=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;t=6&amp;ui=208115253&amp;ti=1033432254190912&amp;s=18579515&amp;m=0&amp;n=01275E8A2B732E72611331E45F00000000&amp;ih=63CCD15EC94E79760E1180743F5C9C46E9F1FF8A&amp;fi=29&amp;pi=1033432253338880&amp;ff=0&amp;co=B3789EBC09FF1DFE5557FDEFBCE51DDC&amp;cm=1&amp;pk=lixian&amp;ak=1:0:6:4&amp;e=1447209695&amp;ms=10485760&amp;ck=601902F2D83C9A97ED4E6FAC83FA4010&amp;at=2D70E9E97F5E0CC55DCDC8B6905B50CB&quot;,&quot;vod&quot;:&quot;0&quot;,&quot;cdn&quot;:[],&quot;format_img&quot;:&quot;rar&quot;,&quot;filesize&quot;:&quot;18579515&quot;,&quot;verify&quot;:&quot;a3d729967d842fed18c7b36308339b25&quot;,&quot;url&quot;:&quot;bt:\/\/63CCD15EC94E79760E1180743F5C9C46E9F1FF8A\/29&quot;,&quot;openformat&quot;:&quot;rar&quot;,&quot;ext&quot;:&quot;rar&quot;,&quot;dirtitle&quot;:&quot;Fonts.rar&quot;,&quot;is_blocked&quot;:0&#125;]&#125;&#125;)</div></pre></td></tr></table></figure>
</li>
</ol>
<p>更多XHR示例可在github项目的xhr-sample目录中找到。</p>
<h3 id="关于迅雷离线的登录验证方式"><a href="#关于迅雷离线的登录验证方式" class="headerlink" title="关于迅雷离线的登录验证方式"></a>关于迅雷离线的登录验证方式</h3><p>一开始我未找到模拟登录迅雷离线的方法，是通过人工登录获取cookie的方式实现的。后来我将登录页面的JS beautify之后，找到了登录API及相应加密算法。用户密码加密基于RSA。我用nodejs+express实现了一个加密密码的API，关键代码如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">app.get(<span class="string">'/api/crypto/rsa_encrypt.do'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> kn = req.query.check_n || <span class="string">'123'</span>;</div><div class="line">    <span class="keyword">var</span> ke = req.query.check_e || <span class="string">'123'</span>;</div><div class="line">    <span class="keyword">var</span> captcha = req.query.captcha || <span class="string">'123'</span>;</div><div class="line">    <span class="keyword">var</span> pwd = req.query.pwd || <span class="string">'123'</span>;</div><div class="line">    <span class="keyword">var</span> rsa = <span class="keyword">new</span> RSAKey();</div><div class="line">    rsa.setPublic(b64tohex(kn), b64tohex(ke));</div><div class="line">    <span class="keyword">var</span> code = captcha.toUpperCase();</div><div class="line">    <span class="keyword">var</span> encrypted_pwd = hex2b64(rsa.encrypt(md5(pwd) + code));</div><div class="line">    res.json(&#123;<span class="string">'encrypted_pwd'</span>:encrypted_pwd&#125;)</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h3 id="离线服务器的验证"><a href="#离线服务器的验证" class="headerlink" title="离线服务器的验证"></a>离线服务器的验证</h3><p>服务端脚本获取到离线下载地址后，需要弄清楚如何让用户能直接用这个链接下载。当然不能直接将服务器通过模拟登录获取到的cookie直接返回给用户。经过测试，发现用户只需要在cookie中提供正确的gdriveid的值，离线服务器就允许用户下载，因此服务器脚本需要返回该值。<br>要实现此功能，服务端脚本关键代码如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#从文件中读入模拟请求所需cookie</span></div><div class="line">cookie = str(open(<span class="string">'cookie.txt'</span>,<span class="string">'rb'</span>).read()).replace(<span class="string">'\n'</span>,<span class="string">''</span>)</div><div class="line">...</div><div class="line"><span class="comment">#从cookie中提取gdriveid字段</span></div><div class="line">app.config[<span class="string">'thunder_gdriveid'</span>] = re.search(<span class="string">r'gdriveid=(\w+?);'</span>, cookie).group(<span class="number">1</span>)</div><div class="line"><span class="comment">#用于返回gdriveid的API</span></div><div class="line"><span class="meta">@app.route('/api/gdriveid', methods=['GET'])</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">API_get_gdriveid</span><span class="params">()</span>:</span></div><div class="line">	<span class="keyword">return</span> jsonify(&#123;<span class="string">'gdriveid'</span>:app.config[<span class="string">'thunder_gdriveid'</span>]&#125;)</div></pre></td></tr></table></figure></p>
<p>用户只需在Aria2请求中带上此cookie即可。在用户端生成的Aria2命令如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">aria2c -c -s10 -x10 --header &quot;Cookie: gdriveid=XXXXX;&quot; -o &quot;filename.XXX&quot; &quot;http://gdl.lixian.vip.xunlei.com/download?...&quot;</div></pre></td></tr></table></figure></p>
<h3 id="服务端实现"><a href="#服务端实现" class="headerlink" title="服务端实现"></a>服务端实现</h3><p>使用Flask框架实现了API server，写了个简易的网页版前端。在API抓到并分析清楚后已没有多大难度，用requests实现模拟操作即可。有以下几点需要注意：  </p>
<ul>
<li>虽尚不明确迅雷离线网页端的登录过期时间是多少，但实验发现若服务器脚本长时间不进行重新登录，模拟请求失败率升高，因此使用cron实现每天定时重新模拟登录一次，获取新的cookie。</li>
<li>服务器需要拥有国内IP，若使用境外VPS做服务器，向迅雷服务器发出的请求很容易被reset。原因未明。</li>
<li>受服务器网络状况影响，单次请求可能耗时较长，为了提高性能，用gunicorn、uwsgi等容器来跑web server。</li>
</ul>
<h3 id="CLI客户端"><a href="#CLI客户端" class="headerlink" title="CLI客户端"></a>CLI客户端</h3><p>对于linux和mac，使用CLI更为方便。目前已上线CLI客户端，python实现，已上传pypi，通过pip可快速安装。使用详情见 <a href="https://github.com/Chion82/xunlei_share.git" target="_blank" rel="external">https://github.com/Chion82/xunlei_share.git</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.chionlab.moe/2016/01/20/thunderhack-development-log/" data-id="ciwkezn32001slr2hdh90zcgp" class="article-share-link">分享</a>
      
        <a href="http://blog.chionlab.moe/2016/01/20/thunderhack-development-log/#disqus_thread" class="article-comment-link">评论</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/crawler/">crawler</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hack/">hack</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-pixivhack-development-log" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/20/pixivhack-development-log/" class="article-date">
  <time datetime="2016-01-19T17:28:14.000Z" itemprop="datePublished">2016-01-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/开发笔记/">开发笔记</a>►<a class="article-category-link" href="/categories/开发笔记/Python/">Python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/20/pixivhack-development-log/">PixivHack：记P站爬图脚本开发</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>由于7月学校考试，预习功课有点忙，最近又忙着做外包，一直都忘了维护博客，所以现在补上上个月本来应该写的技术博文。</p>
<h1 id="这是啥"><a href="#这是啥" class="headerlink" title="这是啥"></a>这是啥</h1><p>跟生活在2.5次元的老司机混久了便跟着入了ACG坑（看到本站首页LL大法时您应该意识到了，博主是个死宅<em>(:з」∠)</em> ）。P站找图是每一个ACG爱好者的必备技能，然而像我这种刚入坑不久的，收藏的画师才几个，再者没有钱买Premium，不能按人气选图，每次找图都要手动一页一页翻(╯‵□′)╯︵┻━┻ 于是我想用Py写个自动爬图脚本。这个脚本可以按你输入的关键词搜索作品，并根据Rating（评分次数，以此来判断作品人气）的最小值来筛选并自动下载，也可以手动指定画师ID列表，也是按照设定最小Rating的方法下载每个画师的图。目前支持下载插画、漫画和大图。</p>
<h1 id="你为什么还不用！"><a href="#你为什么还不用！" class="headerlink" title="你为什么还不用！"></a>你为什么还不用！</h1><p><a href="https://github.com/Chion82/PixivHack.git" target="_blank" rel="external">GitHub链接</a><br>使用方法详见README.md</p>
<h1 id="实现过程"><a href="#实现过程" class="headerlink" title="实现过程"></a>实现过程</h1><ul>
<li>要从P站搜图首先要登录。我原来的设想是通过抓包直接用Py模拟登录，但是不出所料，P站的登录API参数都是经过加密的（貌似是基于RSA的），在不知加密算法的情况下无法实现。（虽然在另一个开源项目中我已经能够分析登录部分的JS加密逻辑，但在那之前我还是懒得审查JS）<br>于是目前的解决方案是要求用户在浏览器登录进P站一次，通过浏览器debugger获取Cookies中的PHPSESSID的值并输入到脚本中，脚本向P站发出的每次http请求都要带上该Cookie，目的是让P站服务器认为我们已经登录。<br>下面贴一行每次请求带上Cookie的代码  <figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">search_result = self.__session.get(<span class="string">'http://www.pixiv.net/search.php?word='</span> + urllib.quote(self.__keyword) + <span class="string">'&amp;p='</span> + str(page), cookies=&#123;<span class="string">'PHPSESSID'</span>: self.__session_id&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>更好的方法：在requests的session中通过headers.update()方法在Header中设置Cookie，该session的每次请求都能自动带上该header，这样就不需要每次都在请求中加上cookies参数</strong></p>
<ul>
<li><p>从HTML源码中提取有用数据：虽然Python中可以使用HTMLParser更灵活地分析HTML，但是由于不想在这个小项目上浪费太多时间，我直接用正则从HTML中匹配。这里贴一行匹配作品搜索列表的代码：  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">result_list = re.findall(<span class="string">r'&lt;a href="(/member_illust\.php\?mode=.*?&amp;amp;illust_id=.*?)"&gt;'</span>, search_result.text)</div></pre></td></tr></table></figure>
</li>
<li><p>自动脚本的流程是：获取作品搜索结果页面，从每个搜索结果分别进入作品首页，判断Rating是否高于设定的最小值（若低于则跳过该作品），判断作品类型（插画/漫画/大图）并根据不同的流程进入作品二级页面并获取原图的URL</p>
</li>
<li><p>绕过P站的防Bot机制：P站的原图不可直接下载。用户在浏览器中访问原图链接时，浏览器会自动加上Refer这个HTTP头，P站图片服务器会验证Refer是否合法。所以，脚本在访问原图链接并下载时，也需要在header中带上Refer。经过测试，Refer的值为作品首页或者作品二级页的URL。总之，在下载原图时带上当前页面（也就是HTML中能找到原图src的页面）的URL作为Refer就不会出问题。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">download_result = self.__session.get(url, cookies=&#123;<span class="string">'PHPSESSID'</span>: self.__session_id&#125;, headers=&#123;<span class="string">'Referer'</span>:referer&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>连接失败处理：经过测试，在长时间连续爬图时很有可能会有一两次requests请求超时（不排除是天朝某墙的TCP RST所致，也有可能是requests2.0在同域下长时间保持单TCP连接使P站服务器拒绝所致），因此，requests每次发出http请求时，都应该用try…except捕获超时异常并重试。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">try</span>:</div><div class="line">	page_result = self.__session.get(url, cookies=&#123;<span class="string">'PHPSESSID'</span>: self.__session_id&#125;, headers=&#123;<span class="string">'Referer'</span>:referer&#125;)</div><div class="line"><span class="keyword">except</span> Exception:</div><div class="line">	print(<span class="string">'Connection failure. Retrying...'</span>)</div><div class="line">	self.__enter_manga_big_page(url, referer, directory)</div><div class="line">	<span class="keyword">return</span></div></pre></td></tr></table></figure>
</li>
<li><p>统计画师总评分数：按关键词爬完一波图后，需要统计所爬的每个画师的ID、Rating等值，方便我们之后能收藏人气高的画师。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">__increment_author_ratings</span><span class="params">(self, author_id, increment, pixiv_id)</span>:</span></div><div class="line">	<span class="keyword">for</span> author <span class="keyword">in</span> self.__author_ratings:</div><div class="line">		<span class="keyword">if</span> (author[<span class="string">'author_id'</span>] == author_id):</div><div class="line">			<span class="keyword">if</span> (pixiv_id <span class="keyword">in</span> author[<span class="string">'illust_id'</span>]):</div><div class="line">				<span class="keyword">return</span></div><div class="line">			author[<span class="string">'total_ratings'</span>] = author[<span class="string">'total_ratings'</span>] + increment</div><div class="line">			author[<span class="string">'illust_id'</span>].append(pixiv_id)</div><div class="line">			<span class="keyword">return</span></div><div class="line">	self.__author_ratings.append(&#123;<span class="string">'author_id'</span>:author_id, <span class="string">'total_ratings'</span>:increment, <span class="string">'illust_id'</span>:[pixiv_id]&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>用户交互：用argparse实现CLI参数传入分析。在本脚本中，通过”-a”或”–authorlist”参数指定存储了画师ID列表的JSON文件。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">parser = argparse.ArgumentParser()</div><div class="line">parser.add_argument(<span class="string">'-a'</span>, <span class="string">'--authorlist'</span>, help=<span class="string">'Crawl illustrations by author IDs. A JSON file containg the list of Pixiv member IDs is required.'</span>)</div><div class="line">args = parser.parse_args()</div></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.chionlab.moe/2016/01/20/pixivhack-development-log/" data-id="ciwkezn2o0019lr2h2xklqu1r" class="article-share-link">分享</a>
      
        <a href="http://blog.chionlab.moe/2016/01/20/pixivhack-development-log/#disqus_thread" class="article-comment-link">评论</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/crawler/">crawler</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Using-Gulp-to-Simplify-Front-end-Development-Workflow" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/20/Using-Gulp-to-Simplify-Front-end-Development-Workflow/" class="article-date">
  <time datetime="2016-01-19T17:20:18.000Z" itemprop="datePublished">2016-01-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/学习笔记/">学习笔记</a>►<a class="article-category-link" href="/categories/学习笔记/前端/">前端</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/20/Using-Gulp-to-Simplify-Front-end-Development-Workflow/">Using Gulp to Simplify Front end Development Workflow</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="What-is-Gulp"><a href="#What-is-Gulp" class="headerlink" title="What is Gulp"></a>What is Gulp</h1><p>Gulp is a streaming build system which is usually used to simplify front-end development workflow, such as automatically minifying JavaScript or compiling LESS. In this tutorial, you’ll learn the basic usage of Gulp.</p>
<h1 id="Preparation"><a href="#Preparation" class="headerlink" title="Preparation"></a>Preparation</h1><p>To make sure you’ll have fun following my instructions, I assume you:</p>
<ul>
<li>have node.js &amp; npm installed</li>
<li>have basic knowledge of node.js scripting.</li>
</ul>
<h1 id="Installing-Gulp"><a href="#Installing-Gulp" class="headerlink" title="Installing Gulp"></a>Installing Gulp</h1><p>Let’s start with the installation of Gulp.<br>Run the following command in your shell terminal. The installation requires sudo or root previlege and you may be required to enter the password.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo npm install --global gulp</div></pre></td></tr></table></figure></p>
<h1 id="Project-Setup"><a href="#Project-Setup" class="headerlink" title="Project Setup"></a>Project Setup</h1><p><code>cd</code> into the root directory of your project and run the following command, which will save the Gulp dependencies in your project directory.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install --save-dev gulp</div></pre></td></tr></table></figure></p>
<h1 id="Create-gulpfile-js"><a href="#Create-gulpfile-js" class="headerlink" title="Create gulpfile.js"></a>Create gulpfile.js</h1><p>At the root of your project, create a <code>gulpfile.js</code> containing the following code.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'mytask'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;  </div><div class="line"> 	<span class="comment">//All task code places here  </span></div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'Hello World!'</span>);  </div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>The code above defines a gulp task named “mytask” with the detailed commands defined in the callback function as the second parameter passed to the <code>gulp.task()</code> method. When running this task, <code>console.log(&#39;Hello World!&#39;);</code> will be executed.</p>
<h1 id="Testing"><a href="#Testing" class="headerlink" title="Testing"></a>Testing</h1><p>Now you should be able to run <code>mytask</code> using the following command:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ gulp mytask</div></pre></td></tr></table></figure></p>
<p>Assume the root directory of your project is <code>~/project</code>, the output should be like:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">➜  project  gulp mytask</div><div class="line">[21:14:25] Using gulpfile ~/project/gulpfile.js</div><div class="line">[21:14:25] Starting <span class="string">'mytask'</span>...</div><div class="line">Hello World!</div><div class="line">[21:14:25] Finished <span class="string">'mytask'</span> after 62 μs</div></pre></td></tr></table></figure></p>
<p>You can always run specific tasks by executing <code>gulp &lt;task&gt; &lt;other_task&gt;</code></p>
<h1 id="Basic-File-Streaming"><a href="#Basic-File-Streaming" class="headerlink" title="Basic File Streaming"></a>Basic File Streaming</h1><p>In this section we’ll use Gulp’s streaming system which is its primary function.<br>We will use <code>Gulp.src()</code>, <code>Gulp.dest()</code>, <code>readable.pipe()</code> to implement a basic JavaScript source file copying program using Gulp.<br>For detailed API doc of the methods above, please refer to <a href="https://github.com/gulpjs/gulp/blob/master/docs/API.md" target="_blank" rel="external">Gulp API doc</a> and <a href="https://nodejs.org/api/stream.html#stream_readable_pipe_destination_options" target="_blank" rel="external">Node.js:Stream</a>.  </p>
<ul>
<li>Create a directory named <code>js</code> at the root of your project (Assume you created this directory: <code>~/project/js</code>) and place some JavaScript files in it.  </li>
<li><p>Add the following code at the end of <code>gulpfile.js</code>  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">gulp.task(<span class="string">'copyjs'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        gulp.src(<span class="string">'js/*.js'</span>)</div><div class="line">           .pipe(gulp.dest(<span class="string">'dest'</span>));</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>At the root of the project which is <code>~/project</code>, run:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ gulp copyjs</div></pre></td></tr></table></figure>
</li>
<li><p>Check out <code>~/project/dest</code> to which you’ll find all js files in <code>~/project/js</code> are copied.</p>
</li>
</ul>
<h1 id="Using-Gulp-to-Minify-JS"><a href="#Using-Gulp-to-Minify-JS" class="headerlink" title="Using Gulp to Minify JS"></a>Using Gulp to Minify JS</h1><p>Next we’ll use Gulp to do some amazing tasks which bring great convenience for front-end development.<br>Let’s start with JavaScript minifying.<br>To make Gulp powerful enouth to do this job, we must install some plugins of Gulp. Here we’ll use <strong>gulp-uglify</strong>.(For more amazing gulp plugins, check out <a href="http://gulpjs.com/plugins/" target="_blank" rel="external">Gulp Plugins</a>)  </p>
<ul>
<li><p>Back to <code>~/project</code>, run the following command to install <strong>gulp-uglify</strong>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install --save-dev gulp-uglify</div></pre></td></tr></table></figure>
</li>
<li><p>Replace <code>gulpfile.js</code> with the following code.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'minifyjs'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        gulp.src(<span class="string">'js/*.js'</span>)	<span class="comment">//Get the stream of the source file</span></div><div class="line">                .pipe(uglify())<span class="comment">//Pass the stream to the uglify module to minify all JS files.</span></div><div class="line">                .pipe(gulp.dest(<span class="string">'build'</span>));<span class="comment">//Pass the stream to the destination directory which is ~/project/build</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>Exucute the task by running:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ gulp minifyjs</div></pre></td></tr></table></figure>
</li>
<li><p>Check out <code>~/project/build</code>. All minified JavaScript source files are placed here!</p>
</li>
</ul>
<h1 id="Using-Gulp-watch"><a href="#Using-Gulp-watch" class="headerlink" title="Using Gulp.watch()"></a>Using Gulp.watch()</h1><p>Sometimes we want the JS files to be automatically minified everytime we modify them and <code>Gulp.watch()</code> will do the trick.<br><code>Gulp.watch()</code> allows us to implement a daemon to monitor file modifications and automatically execute specific tasks every time the modifications are made.  </p>
<ul>
<li><p>Add the following code at the end of <code>gulpfile.js</code>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">gulp.task(<span class="string">'watchjs'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        gulp.watch(<span class="string">'js/*.js'</span>,[<span class="string">'minifyjs'</span>]);	<span class="comment">//Watch all *.js files under ~/project/js directory and run task "minifyjs" when files are modified</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>Execute the daemon task by running:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ gulp watchjs</div></pre></td></tr></table></figure>
</li>
<li><p>Now, JS files will be automatically minified every time you modify them.</p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.chionlab.moe/2016/01/20/Using-Gulp-to-Simplify-Front-end-Development-Workflow/" data-id="ciwkezn1u0006lr2h6v3ynmk1" class="article-share-link">分享</a>
      
        <a href="http://blog.chionlab.moe/2016/01/20/Using-Gulp-to-Simplify-Front-end-Development-Workflow/#disqus_thread" class="article-comment-link">评论</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/front-end/">front-end</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Project-Conclusion-of-m-21dianping-com" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/20/Project-Conclusion-of-m-21dianping-com/" class="article-date">
  <time datetime="2016-01-19T17:13:39.000Z" itemprop="datePublished">2016-01-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/项目总结/">项目总结</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/20/Project-Conclusion-of-m-21dianping-com/">Project Conclusion of m.21dianping.com</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="About-This-Project"><a href="#About-This-Project" class="headerlink" title="About This Project"></a>About This Project</h1><p>The project is a commercial website where users share their experiences of renting houses.<br>I accepted this outsourced project in late April and finished in about 15 days.<br>The project required 2 developers including a front-end engineer and a back-end developer(me).</p>
<blockquote><p><strong>Tasks</strong>: development of the full site, deployment on server, maintainance for 3 months<br><strong>Profits</strong>: 4500 RMB in total, 3000 for back-end developer &amp; maintainer (me), 1500 for front-end engineer.</p>
</blockquote>
<h1 id="Technical-Info"><a href="#Technical-Info" class="headerlink" title="Technical Info"></a>Technical Info</h1><blockquote><p><strong>Back-end Language &amp; Framework</strong>: Python, Flask<br><strong>Database</strong>: MongoDB with mongoengine as ORM python engine<br><strong>Front-end Frameworks</strong>: Bootstrap(UI), Angular.JS(MVVM data-binding)<br><strong>Front-back Interaction Method</strong>: REST API<br><strong>Login Method</strong>: Only OAuth, logging in with Sina Weibo account or QQ account<br><strong>Production Environment</strong>: Nginx + uwsgi<br><strong>About Server</strong>: Ali Cloud, Ubuntu 14.04</p>
</blockquote>
<h1 id="What-I’ve-Done"><a href="#What-I’ve-Done" class="headerlink" title="What I’ve Done"></a>What I’ve Done</h1><ul>
<li>Back-end development</li>
<li>Significant modification of front-end code, including interaction with back-end using AJAX &amp; REST API calls (The front-end developer was really a rookie so I had to do much front-end stuff to fill his void. In fact he did nothing but wrote some static HTML &amp; CSS.)</li>
<li>Server-side production environment set-up</li>
</ul>
<h1 id="What-I’m-Doing"><a href="#What-I’m-Doing" class="headerlink" title="What I’m Doing"></a>What I’m Doing</h1><ul>
<li>Adding source code comments</li>
<li>Working on maintainance documentation</li>
<li>Website &amp; server maintainance</li>
</ul>
<h1 id="What-I’ve-learned"><a href="#What-I’ve-learned" class="headerlink" title="What I’ve learned"></a>What I’ve learned</h1><ul>
<li>Further understanding of Flask</li>
<li>Bootstrap</li>
<li>Front-end MVVM model using Angular.JS</li>
<li>Production environment setup with nginx+uwsgi</li>
</ul>
<h1 id="Improvement"><a href="#Improvement" class="headerlink" title="Improvement"></a>Improvement</h1><p>Search algorithm in back-end source needs to be improved. Current solution of house-info searching is to traverse all records in database and calculate match-weight for each row. However when the number of records grows there may be significant performance issues.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.chionlab.moe/2016/01/20/Project-Conclusion-of-m-21dianping-com/" data-id="ciwkezn1p0003lr2hls5i2nos" class="article-share-link">分享</a>
      
        <a href="http://blog.chionlab.moe/2016/01/20/Project-Conclusion-of-m-21dianping-com/#disqus_thread" class="article-comment-link">评论</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/project/">project</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/page/2/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/学习笔记/">学习笔记</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/学习笔记/OSX/">OSX</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/学习笔记/OpenWRT/">OpenWRT</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/学习笔记/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/学习笔记/前端/">前端</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/学习笔记/后端/">后端</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/开发笔记/">开发笔记</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/开发笔记/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/开发笔记/安卓/">安卓</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/运维/">运维</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/逆向/">逆向</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/项目总结/">项目总结</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/OSX/">OSX</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/">android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/backend/">backend</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/crawler/">crawler</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/front-end/">front-end</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hack/">hack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maintenance/">maintenance</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/network/">network</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openwrt/">openwrt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/project/">project</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/router/">router</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wechat/">wechat</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/OSX/" style="font-size: 11.67px;">OSX</a> <a href="/tags/React/" style="font-size: 13.33px;">React</a> <a href="/tags/android/" style="font-size: 13.33px;">android</a> <a href="/tags/backend/" style="font-size: 11.67px;">backend</a> <a href="/tags/crawler/" style="font-size: 13.33px;">crawler</a> <a href="/tags/front-end/" style="font-size: 15px;">front-end</a> <a href="/tags/hack/" style="font-size: 18.33px;">hack</a> <a href="/tags/linux/" style="font-size: 18.33px;">linux</a> <a href="/tags/maintenance/" style="font-size: 20px;">maintenance</a> <a href="/tags/network/" style="font-size: 11.67px;">network</a> <a href="/tags/nginx/" style="font-size: 13.33px;">nginx</a> <a href="/tags/openwrt/" style="font-size: 15px;">openwrt</a> <a href="/tags/project/" style="font-size: 10px;">project</a> <a href="/tags/python/" style="font-size: 16.67px;">python</a> <a href="/tags/router/" style="font-size: 15px;">router</a> <a href="/tags/wechat/" style="font-size: 11.67px;">wechat</a>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最近发表</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/11/07/tcp-keepalive-on-chrome/">TCP keepalive的探究 (2) : 浏览器的Keepalive机制</a>
          </li>
        
          <li>
            <a href="/2016/09/24/linux-tcp-keepalive/">TCP keepalive的探究 (1) : NAT和保活机制</a>
          </li>
        
          <li>
            <a href="/2016/08/28/mixins-considered-harmful-2/">mixins是有害的（Mixins Considered Harmful）［下篇］</a>
          </li>
        
          <li>
            <a href="/2016/07/23/mixins-considered-harmful/">mixins是有害的（Mixins Considered Harmful）［上篇］</a>
          </li>
        
          <li>
            <a href="/2016/07/13/openwrt-multiwan-configuration/">OpenWRT下双WAN配置</a>
          </li>
        
      </ul>
    </div>
  </div>


  
    <div class="widget-wrap">
  <h3 class="widget-title">友链</h3>
  <div class="widget">
    <a href="https://www.starduster.me" target="_blank">星尘独奏曲</a><br/>
    <a href="http://www.zhouchao.me" target="_blank">chao's blog</a><br/>
    <a href="http://ilazycat.com" target="_blank">小黑猫菊苣的猫窝</a><br/>
    <a href="https://loli.be" target="_blank">Mashiro's Blog</a><br/>
    <a href="https://bismarck.moe" target="_blank">雨宫千鹤的博客</a>
  </div>
</div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Chion Tang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, themed &amp; customized by Chion
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">主页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="https://github.com/Chion82" class="mobile-nav-link">GitHub</a>
  
    <a href="/about.html" class="mobile-nav-link">About Me</a>
  
</nav>
    
<script>
  var disqus_shortname = 'chionlab';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//code.jquery.com/jquery-2.2.0.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>